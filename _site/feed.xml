<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2025-10-31T11:34:34+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Garden Of Garbage</title><subtitle>a garden to log the garbage of my life</subtitle><entry><title type="html">Spectroscopic constant of diatomic molecule : HF as an example</title><link href="http://localhost:4000/jekyll/update/2025/10/28/hfbond.html" rel="alternate" type="text/html" title="Spectroscopic constant of diatomic molecule : HF as an example" /><published>2025-10-28T20:41:29+08:00</published><updated>2025-10-28T20:41:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/10/28/hfbond</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/10/28/hfbond.html"><![CDATA[<h2 id="background">Background</h2>
<p>HF is a diatomic molecule and  here we want to use it as an example to 
demostrate how to fitting spectroscopic constant.</p>

<h2 id="optimization-of-r_e">Optimization of \(R_e\)</h2>
<p>First of all ,we use molpro to optimize the equilibrum bond distance of HF molecule
using both caspt2 method and nevpt2 method</p>

<p>This is  an input which optimize HF using nevpt2/cc-pvqz</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">basis</span><span class="o">=</span><span class="n">cc</span><span class="o">-</span><span class="n">pvqz</span>
</span><span class="hll"><span class="n">angstrom</span>
</span><span class="n">geometry</span><span class="o">=</span><span class="p">{</span>
    <span class="n">angstrom</span><span class="p">;</span>
    <span class="no">H</span>  <span class="p">;</span>
    <span class="no">F</span> <span class="no">H</span> <span class="n">r</span> <span class="p">;</span>
<span class="p">}</span>
<span class="n">r</span><span class="o">=</span><span class="mf">0.9</span>
<span class="n">hf</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">hf</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span>    <span class="n">multi</span><span class="p">,</span>
<span class="n">occ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,;</span>
<span class="n">closed</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">;</span>
<span class="n">wf</span><span class="p">,</span><span class="n">elec</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sym</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">cas</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span>    <span class="n">nevpt2</span><span class="p">,</span>
    <span class="n">state</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">{</span><span class="n">optg</span><span class="p">,</span><span class="n">root</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">procedure</span><span class="o">=</span><span class="n">mycas</span><span class="p">}</span>
<span class="n">mycas</span><span class="o">=</span><span class="p">{</span><span class="n">hf</span><span class="p">;</span><span class="n">multi</span><span class="p">;</span><span class="n">nevpt2</span><span class="p">}</span></code></pre></figure>

<p>This is an optimization file for dsrg</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">import</span> <span class="n">forte</span>
</span><span class="hll">
</span><span class="n">molecule</span> <span class="p">{</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="no">H</span>
<span class="no">F</span> <span class="mi">1</span> <span class="mf">0.9</span>
<span class="p">}</span>

<span class="n">set</span> <span class="p">{</span>
  <span class="n">basis</span>                <span class="n">cc</span><span class="o">-</span><span class="n">pvqz</span>
  <span class="n">reference</span>            <span class="n">rhf</span>
  <span class="n">scf_type</span>             <span class="n">pk</span>
  <span class="n">e_convergence</span>        <span class="mi">10</span>
  <span class="n">d_convergence</span>        <span class="mi">10</span>
  <span class="n">restricted_docc</span>      <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">active</span>               <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">mcscf_type</span>           <span class="n">conv</span>
  <span class="n">mcscf_maxiter</span>        <span class="mi">100</span>
  <span class="n">mcscf_diis_start</span>     <span class="mi">20</span>
  <span class="n">mcscf_e_convergence</span>  <span class="mi">10</span>
  <span class="n">mcscf_r_convergence</span>  <span class="mi">8</span>
  <span class="n">g_convergence</span>        <span class="n">gau_verytight</span>
<span class="p">}</span>

<span class="n">set</span> <span class="n">forte</span> <span class="p">{</span>
  <span class="n">ref_type</span>             <span class="n">casscf</span>
  <span class="n">restricted_docc</span>      <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">active</span>               <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">active_space_solver</span>  <span class="n">detci</span>
  <span class="n">correlation_solver</span>   <span class="n">dsrg</span><span class="o">-</span><span class="n">mrpt2</span>
  <span class="n">dsrg_s</span>               <span class="mf">0.5</span>
  <span class="n">force_diag_method</span>    <span class="kp">true</span>
<span class="p">}</span></code></pre></figure>

<table>
  <thead>
    <tr>
      <th>Basis Set</th>
      <th>CASPT2</th>
      <th>NEVPT2</th>
      <th>DSRG-PT2(s=0.5)</th>
      <th>DSRG-PT2(s=1.0)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cc-pVDZ</td>
      <td>0.92033766</td>
      <td>0.92384987</td>
      <td>0.917399</td>
      <td>0.913450</td>
    </tr>
    <tr>
      <td>cc-pVTZ</td>
      <td>0.91719700</td>
      <td>0.92249350</td>
      <td>0.915964</td>
      <td>0.910931</td>
    </tr>
    <tr>
      <td>cc-pVQZ</td>
      <td>0.91579604</td>
      <td>0.92159519</td>
      <td>0.916780</td>
      <td>0.914105</td>
    </tr>
  </tbody>
</table>

<h2 id="calculation-of-spectroscopic-constant">Calculation of Spectroscopic Constant</h2>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> <span class="o">&amp;</span><span class="no">VIBROT</span>
</span><span class="hll">  <span class="no">RoVibrational</span> <span class="n">spectrum</span>
</span>  <span class="no">Title</span> <span class="o">=</span> <span class="no">HF</span> <span class="p">(</span><span class="o">^</span><span class="mi">1</span> <span class="no">Pi_u</span><span class="p">)</span>
  <span class="no">Atoms</span> <span class="o">=</span> <span class="mi">0</span> <span class="no">H</span> <span class="mi">0</span> <span class="no">F</span>
  <span class="no">Potential</span>
<span class="mf">0.4000</span>	 <span class="o">-</span><span class="mf">98.39414876</span>
<span class="mf">0.4500</span>	 <span class="o">-</span><span class="mf">98.95737209</span>
<span class="mf">0.5000</span>	 <span class="o">-</span><span class="mf">99.33419285</span>
<span class="mf">0.5500</span>	 <span class="o">-</span><span class="mf">99.58745543</span>
<span class="mf">0.6000</span>	 <span class="o">-</span><span class="mf">99.75756806</span>
<span class="mf">0.6500</span>	 <span class="o">-</span><span class="mf">99.87102993</span>
<span class="mf">0.7000</span>	 <span class="o">-</span><span class="mf">99.94547732</span>
<span class="mf">0.7500</span>	 <span class="o">-</span><span class="mf">99.99282331</span>
<span class="mf">0.8000</span>	 <span class="o">-</span><span class="mf">100.02124762</span>
<span class="mf">0.8250</span>	 <span class="o">-</span><span class="mf">100.03021940</span>
<span class="mf">0.8500</span>	 <span class="o">-</span><span class="mf">100.03645446</span>
<span class="mf">0.8750</span>	 <span class="o">-</span><span class="mf">100.04040903</span>
<span class="mf">0.9000</span>	 <span class="o">-</span><span class="mf">100.04246762</span>
<span class="mf">0.9250</span>	 <span class="o">-</span><span class="mf">100.04295454</span>
<span class="mf">0.9500</span>	 <span class="o">-</span><span class="mf">100.04214339</span>
<span class="mf">0.9750</span>	 <span class="o">-</span><span class="mf">100.04026516</span>
<span class="mf">1.0000</span>	 <span class="o">-</span><span class="mf">100.03751494</span>
<span class="mf">1.0250</span>	 <span class="o">-</span><span class="mf">100.03405765</span>
<span class="mf">1.0500</span>	 <span class="o">-</span><span class="mf">100.03003295</span>
<span class="mf">1.0750</span>	 <span class="o">-</span><span class="mf">100.02555925</span>
<span class="mf">1.1000</span>	 <span class="o">-</span><span class="mf">100.02073718</span>
<span class="mf">1.1250</span>	 <span class="o">-</span><span class="mf">100.01565243</span>
<span class="mf">1.1500</span>	 <span class="o">-</span><span class="mf">100.01037810</span>
<span class="mf">1.2000</span>	 <span class="o">-</span><span class="mf">99.99950138</span>
<span class="mf">1.2500</span>	 <span class="o">-</span><span class="mf">99.98850518</span>
<span class="mf">1.3000</span>	 <span class="o">-</span><span class="mf">99.97767860</span>
<span class="mf">1.3500</span>	 <span class="o">-</span><span class="mf">99.96722798</span>
<span class="mf">1.4000</span>	 <span class="o">-</span><span class="mf">99.95729554</span>
<span class="mf">1.4500</span>	 <span class="o">-</span><span class="mf">99.94797370</span>
<span class="mf">1.5000</span>	 <span class="o">-</span><span class="mf">99.93931638</span>
<span class="mf">1.5500</span>	 <span class="o">-</span><span class="mf">99.93134832</span>
<span class="mf">1.6000</span>	 <span class="o">-</span><span class="mf">99.92407265</span>
<span class="mf">1.6500</span>	 <span class="o">-</span><span class="mf">99.91747685</span>
<span class="mf">1.7000</span>	 <span class="o">-</span><span class="mf">99.91153737</span>
<span class="mf">1.7500</span>	 <span class="o">-</span><span class="mf">99.90622293</span>
<span class="mf">1.8000</span>	 <span class="o">-</span><span class="mf">99.90149693</span>
<span class="mf">1.8500</span>	 <span class="o">-</span><span class="mf">99.89731924</span>
<span class="mf">1.9000</span>	 <span class="o">-</span><span class="mf">99.89364747</span>
<span class="mf">1.9500</span>	 <span class="o">-</span><span class="mf">99.89043804</span>
<span class="mf">2.0000</span>	 <span class="o">-</span><span class="mf">99.88764711</span>
<span class="mf">2.0500</span>	 <span class="o">-</span><span class="mf">99.88523151</span>
<span class="mf">2.1000</span>	 <span class="o">-</span><span class="mf">99.88314945</span>
<span class="mf">2.1500</span>	 <span class="o">-</span><span class="mf">99.88136132</span>
<span class="mf">2.2000</span>	 <span class="o">-</span><span class="mf">99.87983017</span>
<span class="mf">2.3000</span>	 <span class="o">-</span><span class="mf">99.87740696</span>
<span class="mf">2.4000</span>	 <span class="o">-</span><span class="mf">99.87564961</span>
<span class="mf">2.5000</span>	 <span class="o">-</span><span class="mf">99.87438007</span>
<span class="mf">2.6000</span>	 <span class="o">-</span><span class="mf">99.87346539</span>
<span class="mf">2.7000</span>	 <span class="o">-</span><span class="mf">99.87280811</span>
<span class="mf">2.8000</span>	 <span class="o">-</span><span class="mf">99.87233707</span>
<span class="mf">2.9000</span>	 <span class="o">-</span><span class="mf">99.87200028</span>
<span class="mf">3.0000</span>	 <span class="o">-</span><span class="mf">99.87175975</span>
<span class="mf">4.0000</span>	 <span class="o">-</span><span class="mf">99.87116318</span>
<span class="mf">5.0000</span>	 <span class="o">-</span><span class="mf">99.87114070</span>
 <span class="no">DistUnit</span> <span class="o">=</span> <span class="n">angstrom</span>
  <span class="no">EnerUnit</span> <span class="o">=</span> <span class="n">hartree</span> 
  <span class="no">Grid</span> <span class="o">=</span> <span class="mi">450</span>
  <span class="no">Range</span> <span class="o">=</span> <span class="mf">0.85</span> <span class="mf">9.4</span>
  <span class="no">Vibrations</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">scale</span></code></pre></figure>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background HF is a diatomic molecule and here we want to use it as an example to demostrate how to fitting spectroscopic constant.]]></summary></entry><entry><title type="html">Generate auxiliary basis set using autoaux</title><link href="http://localhost:4000/jekyll/update/2025/10/28/autoaux.html" rel="alternate" type="text/html" title="Generate auxiliary basis set using autoaux" /><published>2025-10-28T20:41:29+08:00</published><updated>2025-10-28T20:41:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/10/28/autoaux</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/10/28/autoaux.html"><![CDATA[<h2 id="background">Background</h2>
<p>Density Fitting is a common technique to accelerate 
calculation in quantum chemistry. And we need auxiliary 
basis set.For some basis set there are pre-optimized auxiliary basisset 
for other we need to use autoaux to generate.
The reference is</p>

<p>doi: 10.1021/acs.jctc.6b01041</p>

<h2 id="basis-set-exchange">Basis Set Exchange</h2>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">from</span> <span class="n">basis_set_exchange</span><span class="p">.</span><span class="nf">api</span> <span class="n">import</span> <span class="n">get_basis</span>
</span><span class="hll"><span class="n">bs</span><span class="o">=</span><span class="n">get_basis</span><span class="p">(</span><span class="s2">"cc-pv5z"</span><span class="p">,</span><span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s2">"psi4"</span><span class="p">,</span>
</span>             <span class="n">get_aux</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fhand</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"cc-pv5z-autoaux"</span><span class="p">,</span><span class="s2">"w"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">fhand</span><span class="p">)</span>
<span class="n">fhand</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span></code></pre></figure>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background Density Fitting is a common technique to accelerate calculation in quantum chemistry. And we need auxiliary basis set.For some basis set there are pre-optimized auxiliary basisset for other we need to use autoaux to generate. The reference is]]></summary></entry><entry><title type="html">Simplified Tamm-Dancoff approximation to TD-DFT</title><link href="http://localhost:4000/jekyll/update/2025/08/08/stda.html" rel="alternate" type="text/html" title="Simplified Tamm-Dancoff approximation to TD-DFT" /><published>2025-08-08T20:41:29+08:00</published><updated>2025-08-08T20:41:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/08/08/stda</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/08/08/stda.html"><![CDATA[<h2 id="background">Background</h2>
<p>reference</p>

<p>The time-dependent density functional theory (TD-DFT) responce 
problem can be expressed as the following non-Hermitian eigenvalue problem</p>

<p>\(\begin{pmatrix}
 A &amp; B \\
 B^{*}&amp; A^{*} 
\end{pmatrix}
\begin{pmatrix}
X \\
Y
\end{pmatrix}
= 
\begin{pmatrix}
\omega &amp; 0\\
0&amp; \omega 
\end{pmatrix}
\begin{pmatrix}
X \\
Y
\end{pmatrix}\)
In the Tamm-Dancoff approximation (TDA), the matrix B is neglected which leads to</p>

<p>\(AX=\omega X\)
Three simplifications then yield the simplified Tamm-Dancoff approach (sTDA)</p>
<ol>
  <li>Neglect the responce of exchange-correlation functional</li>
  <li>Evaluate the two-electron integrals as damped Coulomb interactions between transition/charge density monopoles</li>
  <li>Restrict the configuration sapce to a user-specified energy range of excitations</li>
</ol>

<p>The elements of the simplified matrix are then given as</p>

<p>\(A^\prime_{ia,jb}=\delta_{ij}\delta_{ab}(\epsilon_a-\epsilon_b)+\sum_{A,B}^{N_{atoms}}
(s_k q_{ia}^{A}\gamma_{AB}^{K}q_{jb}^B-q_{ia}^{A}\gamma_{AB}^{J}q_{jb}^B)\)
\(q_{ia}^{A}\) are the transition/charge density monopoles located on atom A .
These are obtained from Lowdin population analysis.
\(\epsilon_p\) is the Kon-Sham orbital energy of orbital p.
In the spin-restricted case,\(s_k=2\) for singlet-singlet transition ,\(s_k=0\) for singlet-triplet exictaions.
\(\gamma_{AB}^K\) and \(\gamma_{AB}^J\) are the Mataga-Nishimoto-Ohno-Klopman damped Coulomb operators for exchange-type 
and Coulom-type integrals ,respectively.
\(\gamma_{AB}^{J}=(\frac{1}{R_{AB}^\beta+(a_x\eta)^{-\beta}})^{1/\beta}\)</p>

<h2 id="tddft">TDDFT</h2>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background reference]]></summary></entry><entry><title type="html">QUESTDB and excited state quantum chemistry method</title><link href="http://localhost:4000/jekyll/update/2025/07/03/questdb.html" rel="alternate" type="text/html" title="QUESTDB and excited state quantum chemistry method" /><published>2025-07-03T21:28:29+08:00</published><updated>2025-07-03T21:28:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/07/03/questdb</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/07/03/questdb.html"><![CDATA[<h2 id="background">Background</h2>
<p>QUESTDB( https://lcpq.github.io/QUESTDB_website/ )
is quantum excited state database which benchmark quantum chemistry method for excited state.
The Journal of Physical Chemistry Letters 2020 116, 2374-2383
DOI: 10.1021/acs.jpclett.0c00014</p>
<h2 id="develop-theories-for-excited-is-more-complex">Develop theories for excited is more complex</h2>
<ol>
  <li>excited state lack a proper vairational principle</li>
  <li>excited state have very difference natures ( \(\pi-&gt;\pi*\),\(n-&gt;\pi*\) charge transfer ,double excitateion ,valence ,Rydberg ,singlet ,triplet )</li>
</ol>

<h2 id="method">Method</h2>
<ol>
  <li>first ab initial method for excited was CIS in 1970 , error ~1 eV, CIS(D) has error 0.2-0.3 eV</li>
  <li>CASSCF and CASPT2,NEVPT2 is more reliable and has error 0.1-0.2</li>
  <li>TD-DFT 0.2-0.4 ev for low lying valence excited state, but not goot for charge-transfer , Rydberg state and double excitation.</li>
  <li>EOM-CCSD 0.1 eV</li>
  <li>ADC (2) 0.1-0.2 ev  ADC(3)</li>
  <li>BSE GW  0.1-0.3 EV</li>
  <li>selected CI (SCI)
    <h2 id="usage">Usage</h2>
    <p>You can download the geometry and reference energy from QUESTDB here is an example
I calculate EOM-CCSD of acetaldehyde using molpro</p>
    <h3 id="input">input</h3>
    <p>geometry download from questdb</p>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="mi">7</span>
</span><span class="hll">
</span><span class="no">C</span>   <span class="o">-</span><span class="mf">0.00124094</span>            <span class="mf">0.00000000</span>            <span class="mf">0.46104598</span>
<span class="no">C</span>   <span class="o">-</span><span class="mf">0.93054640</span>            <span class="mf">0.00000000</span>           <span class="o">-</span><span class="mf">0.71424991</span>
<span class="no">O</span>    <span class="mf">1.20624568</span>            <span class="mf">0.00000000</span>            <span class="mf">0.38083840</span>
<span class="no">H</span>   <span class="o">-</span><span class="mf">0.49162964</span>            <span class="mf">0.00000000</span>            <span class="mf">1.44957198</span>
<span class="no">H</span>   <span class="o">-</span><span class="mf">1.57671241</span>            <span class="mf">0.87868017</span>           <span class="o">-</span><span class="mf">0.66257994</span>
<span class="no">H</span>   <span class="o">-</span><span class="mf">1.57671241</span>           <span class="o">-</span><span class="mf">0.87868017</span>           <span class="o">-</span><span class="mf">0.66257994</span>
<span class="no">H</span>   <span class="o">-</span><span class="mf">0.37065389</span>            <span class="mf">0.00000000</span>           <span class="o">-</span><span class="mf">1.64609256</span></code></pre></figure>

<p>molpro input</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">basis</span><span class="o">=</span><span class="n">aug</span><span class="o">-</span><span class="n">cc</span><span class="o">-</span><span class="n">pvtz</span>    <span class="o">!</span> <span class="n">define</span> <span class="n">basis</span> <span class="n">set</span>
</span><span class="hll"><span class="n">geometry</span><span class="o">=</span><span class="n">acetaldehyde</span><span class="p">.</span><span class="nf">xyz</span>  <span class="o">!</span> <span class="n">read</span> <span class="n">geometry</span>
</span><span class="n">hf</span>                         <span class="o">!</span> <span class="k">do</span> <span class="n">scf</span> <span class="n">calculation</span>
<span class="n">ccsd</span>                       <span class="o">!</span> <span class="k">do</span> <span class="n">ccsd</span> <span class="n">calculation</span>
<span class="n">start</span> <span class="p">,</span><span class="mf">4000.2</span> <span class="n">save</span> <span class="mf">4000.2</span> <span class="o">!</span> <span class="n">save</span> <span class="n">final</span> <span class="no">T</span> <span class="n">amplitudes</span>
<span class="n">eom</span> <span class="mf">2.1</span> <span class="mf">1.1</span>  <span class="mf">1.2</span>  <span class="mf">2.2</span>     <span class="o">!</span> <span class="n">ground</span> <span class="n">state</span> <span class="n">is</span> <span class="mf">1.1</span> <span class="n">first</span> <span class="n">exited</span> <span class="n">state</span> <span class="n">is</span> <span class="mf">1.2</span></code></pre></figure>

<p>output</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll">   <span class="no">Final</span> <span class="no">Results</span><span class="p">:</span>
</span><span class="hll">   <span class="o">==============</span>
</span> 
   <span class="no">State</span>    <span class="no">Exc</span><span class="o">.</span> <span class="no">Energy</span>    <span class="no">Total</span> <span class="no">Energy</span>     <span class="no">Weight</span><span class="p">(</span><span class="no">S</span><span class="p">)</span>     <span class="no">Weight</span><span class="p">(</span><span class="no">D</span><span class="p">)</span>      <span class="no">Delta</span> <span class="no">E</span>    <span class="no">Conv</span>   <span class="no">Max</span><span class="o">.</span> <span class="no">Coef</span><span class="o">.</span>     <span class="no">Excitation</span>
    <span class="mf">1.1</span>     <span class="mf">0.00000000</span>    <span class="o">-</span><span class="mf">153.57317406</span>     <span class="mf">0.635E-02</span>     <span class="mf">0.156E+00</span>    <span class="o">-</span><span class="mf">0.124E-06</span>     <span class="no">Y</span>
    <span class="mf">1.2</span>     <span class="mf">0.16029771</span>    <span class="o">-</span><span class="mf">153.41287635</span>     <span class="mf">0.928E+00</span>     <span class="mf">0.724E-01</span>     <span class="mf">0.122E-06</span>     <span class="no">Y</span>    <span class="o">-</span><span class="mf">0.76471</span>     <span class="mf">10.1</span> <span class="o">-&gt;</span>  <span class="mf">6.2</span>
    <span class="mf">2.1</span>     <span class="mf">0.25671913</span>    <span class="o">-</span><span class="mf">153.31645494</span>     <span class="mf">0.924E+00</span>     <span class="mf">0.757E-01</span>     <span class="mf">0.837E-06</span>     <span class="no">Y</span>    <span class="o">-</span><span class="mf">0.75379</span>     <span class="mf">10.1</span> <span class="o">-&gt;</span> <span class="mf">11.1</span>
    <span class="mf">2.2</span>     <span class="mf">0.29101596</span>    <span class="o">-</span><span class="mf">153.28215811</span>     <span class="mf">0.924E+00</span>     <span class="mf">0.759E-01</span>    <span class="o">-</span><span class="mf">0.351E-06</span>     <span class="no">Y</span>    <span class="o">-</span><span class="mf">0.81336</span>     <span class="mf">10.1</span> <span class="o">-&gt;</span>  <span class="mf">3.2</span></code></pre></figure>

<h3 id="conclusion">Conclusion</h3>
<p>you can search</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background QUESTDB( https://lcpq.github.io/QUESTDB_website/ ) is quantum excited state database which benchmark quantum chemistry method for excited state. The Journal of Physical Chemistry Letters 2020 116, 2374-2383 DOI: 10.1021/acs.jpclett.0c00014 Develop theories for excited is more complex excited state lack a proper vairational principle excited state have very difference natures ( \(\pi-&gt;\pi*\),\(n-&gt;\pi*\) charge transfer ,double excitateion ,valence ,Rydberg ,singlet ,triplet )]]></summary></entry><entry><title type="html">frozen core and basis set</title><link href="http://localhost:4000/jekyll/update/2025/07/03/frozen_core.html" rel="alternate" type="text/html" title="frozen core and basis set" /><published>2025-07-03T21:28:29+08:00</published><updated>2025-07-03T21:28:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/07/03/frozen_core</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/07/03/frozen_core.html"><![CDATA[<h2 id="background">Background</h2>
<p>reference</p>

<p>J. Chem. Theory Comput. 2025, 21, 6, 2977–2987 https://doi.org/10.1021/acs.jctc.4c01731</p>

<p>A very widely applied approximation for electron correlation
methods  is the frozen-core approximation,
whereby the lowest lying MOs are “frozen”, prohibiting
excitations from these orbitals and only including excitations
from valence or “active” orbitals. This approximation also
coincides with an intuitive chemist’s picture where the core
electrons are considered to be less sensitive to changes in the
environment and chemical reactions are determined by valence
electrons. 
In fact, it has been found that the error introduced
by the frozen-core approximation is minimal in terms of
relative energies and additionally for geometries of
related methods.
Furthermore, for practical applications,
the use of the frozen-core approximation is preferred since
most of the commonly used basis sets are designed to correlate
the valence electrons only.</p>
<h2 id="basis-set">basis set</h2>
<p>Specifically, most AO and auxiliary
basis sets are not equipped to describe the core region
sufficiently and special basis functions, that is, Gaussians with
large exponents, would have to be added to the basis sets in
order to describe the correlation between core electrons as well
as core and active electrons such as, for example, in
Dunning’s cc-pCVXZ73 and cc-pwCVXZ74 basis sets (where X
= D, T, Q, 5, …).</p>
<h2 id="auxiliary-basis-set">auxiliary basis set</h2>
<p>The problem with auxiliary basis sets is even
more obvious since they are often developed within the frozen-
core approximation and, thus, do not contain any core
functions. One possible solution is the use of automatically
generated auxiliary basis sets, for example, developed by Neese
and coworkers.75 However, these basis sets are usually about
twice the size of optimized basis sets, which makes the
computation much more expensive. Another possible solution
lies in the utilization of optimized auxiliary basis sets in
combination with the frozen-core approximation for the
underlying electron correlation method, which allows to
overcome the restrictions on the basis set selection.</p>
<h2 id="advatages-of-using-frozen-core-approximation">advatages of using frozen core approximation</h2>
<p>A further
advantage when using the frozen-core approximation comes
with the increased computational efficiency since the active
occupied space excludes the core electrons. 
Thus, the limited
availability of all-electron basis sets together with the higher
computational cost for larger basis sets makes the use of the
frozen-core approximation preferable within electron correla-
tion methods.
In addition, the frozen-core approximation
entails no significant loss of accuracy for quantities such as
structural parameters or relative energies.</p>

<h2 id="how-to---choose-the-number-of-frozen-core-and-potential-problem">How to   choose the number of frozen core and potential problem</h2>
<p>The definition of core electrons,Chemical Physics Letters,Volume 350, Issues 5–6,2001,Pages 573-576,
https://doi.org/10.1016/S0009-2614(01)01345-8.</p>

<p>A common practice is to carry out a Hartree–Fock calculation on the electronic ground state 
 and then to select the appropriate number of orbitals with the lowest one-electron energies .
However, difficulties arise when the core energies of one atom lie above the energies of some valence atomic orbitals of another atom .
A notable example is gallium trifluoride GaF3, where the energy of a gallium 3d-orbital lies above that of a fluorine 2s orbital. 
In the G2 model, the former is treated as a part of the core while the latter is part of the valence shell</p>

<p>The number of core electrons are 
2(Li to Mg) 10(Al to Ca) 18 (Sc to Kr)</p>

<h3 id="conclusion">Conclusion</h3>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background reference]]></summary></entry><entry><title type="html">Example of Generalized Normal Order</title><link href="http://localhost:4000/jekyll/update/2025/05/30/GNO.html" rel="alternate" type="text/html" title="Example of Generalized Normal Order" /><published>2025-05-30T16:28:29+08:00</published><updated>2025-05-30T16:28:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/05/30/GNO</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/05/30/GNO.html"><![CDATA[<h2 id="background">Background</h2>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background]]></summary></entry><entry><title type="html">Cumulant And Cumulant Decomposition</title><link href="http://localhost:4000/jekyll/update/2025/05/28/cumulant.html" rel="alternate" type="text/html" title="Cumulant And Cumulant Decomposition" /><published>2025-05-28T16:28:29+08:00</published><updated>2025-05-28T16:28:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/05/28/cumulant</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/05/28/cumulant.html"><![CDATA[<h2 id="background">Background</h2>
<p>Here we want to demostate the decomposite of three body operator into two body operator by cumulant decomposition.The reference paper is</p>

<p>J. Chem. Phys. 127, 104107 (2007)
https://doi.org/10.1063/1.2761870</p>

<h2 id="main-result">Main result</h2>
<p>the main result is  equation #(7)</p>

\[a_{stu}^{pqr}\implies 9(\gamma^p_s \wedge a^{qr}_{ut}) -12 (\gamma^p_s \wedge \gamma^q_t \wedge \gamma^r_u)\]

<p>The notation \(a_{stu}^{pqr}\) is operator ,\(\gamma\) is reduced density matrix , but how does \(\wedge\) and the coefficent 9 and -12 comes from ?</p>
<h2 id="relation-between-rdm-and-cumulant">Relation between RDM and Cumulant</h2>

<p>The answer comes from equation #(8-10)
\(\gamma^p_s=\lambda^p_s \\
\gamma^{pq}_{st}=\lambda^{pq}_{st} + (\lambda^p_s \lambda^q_t -\lambda^p_t\lambda^q_s) \\
\gamma^{pqr}_{stu}=\lambda^{pqr}_{stu}+(\lambda^p_s\lambda^{qr}_{tu}+\cdots)+(\lambda^p_s \lambda^q_t \lambda^r_u+\cdots)\)</p>

<p>The question now is why  this relation is true ? The answer is that the quantity \(\lambda\) which is named kumulant is defined to be make this relationship true.</p>
<h2 id="cumulant-by-axioms">Cumulant by axioms</h2>

<p>J. Chem. Theory Comput. 2020, 16, 10, 6150–6164
https://doi.org/10.1021/acs.jctc.0c00422</p>

<p>cumulant definition by three axioms</p>
<ol>
  <li>Fuctional Axioms \(\lambda=\sum_\rho \mu_\rho \gamma(\rho)\)
Here the \(\rho\) is fermionic partition and \(\mu_\rho\) is Mobius function .</li>
  <li>
    <p>Normalization \(\mu^{pq\cdots}_{rs\cdots}=1\)</p>
  </li>
  <li>Additiv Separability</li>
</ol>

<p>If RDM \(\gamma^{pq\cdots}_{rs\cdots}\) is multiplicatively seperable,then \(\lambda^{pq\cdots}_{rs\cdots}\) is additivly seperable.</p>
<h3 id="additive-separability-from-multiplicative-separability">Additive Separability from Multiplicative Separability</h3>
<p>The key object we consider are antisymmetic tensros with n uppder index and n lower index.</p>

<p>Suppose the index can be partitioned into subsets, called blocks
\(p,q,r,s\)
in one block \(u,v\) in another block.</p>

<p>If the antisymmetry tensor satisfing the following relationship ,we call this tensor is multiplicative separable with respect to the partition.</p>

\[A_{pur}^{qsv}=-A_{pru}^{qsv}=-A_{pr}^{qs}A_{u}^{v}\]

<p>Additive separability means that the tensor for the symtem with orbitals from all blocks of the partion is the sum of tensors with orbitals from only as singel block of partition</p>

<p>\(A_{pur}^{qsv}=-A_{pru}^{qsv}=-(A_{pr}^{qs}+A_{u}^{v})\)</p>
<h3 id="manually-construct">Manually construct</h3>
<p>Let \(\gamma_{pr}^{qs}\) be multiplicative separable.</p>

<p>Then  define
\(\lambda_{pr}^{qs}\equiv \gamma_{pr}^{qs}-\gamma_p^q\gamma_r^s+\gamma_p^s\gamma_r^q\)</p>

<p>If Index \(p,q\) is in one block ,and \(r,s\) in another block,then \(\gamma_p^s=\gamma_r^q=0\),
\(\lambda_{pr}^{qs}=\gamma_{pr}^{qs}-\gamma_p^q\gamma_r^s+0=0\)</p>

<p>Similaly,if index \(p,r\) is in one block ,and \(q,s\) in another block,then \(\gamma_p^q=\gamma_r^s=0\),
\(\lambda_{pr}^{qs}=-\gamma_{pr}^{sq}-0+\gamma_p^q\gamma_r^s =0\)</p>
<h3 id="fermionic-partition">Fermionic Partition</h3>

<p>Fermionic Partition is normal partition plus all unique term generated by permutation operator.
The begining relationship is equation #(18) in jctc paper metioned above</p>

<p>\(\gamma^{pq\cdots}_{rs\cdots}=\sum_\rho \lambda(\rho)\)
Here we will generate the diagram</p>

<p>Due to time limitationn ,I will rewrite this post laterly.</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background Here we want to demostate the decomposite of three body operator into two body operator by cumulant decomposition.The reference paper is]]></summary></entry><entry><title type="html">Calculation of benzene</title><link href="http://localhost:4000/jekyll/update/2025/05/25/benzene.html" rel="alternate" type="text/html" title="Calculation of benzene" /><published>2025-05-25T11:26:29+08:00</published><updated>2025-05-25T11:26:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/05/25/benzene</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/05/25/benzene.html"><![CDATA[<h2 id="background">Background</h2>
<p>Here we want to calculate the adiabatic excitation energy of benzene.
For introduction and the source of sturcture ,see previous  post<a href="/jekyll/update/2025/05/19/calculation-gallary.html">calculation of acetylene </a></p>

<p><img src="/image/c2cs35394f-f1.gif" alt="AltText" /></p>

<p>It is obvious that the active space of benzene should be six pz orbital of carbon atoms.But here ,we want to demostrate the use of 
point group symmetry to help us find the correct  active space.</p>

<h2 id="symmetry-of-benzene-pi-bond">Symmetry of benzene \(\pi\) bond</h2>

<p>This section is a summary of the 10-6 section of book Group Theory and Chemistry (Dover Books on Chemistry) by David M. Bishop</p>

<p>First, we can use the six orbital as the basis of reducible representation space \(V\).</p>

<p>Next , we decomposite the reducible repsentation space \(V\) into irreducible representation spaces \(V^{\mu}\).</p>

\[\Gamma^{AO}=\Gamma^{A_{2u}}\oplus \Gamma^{B_{2g}} \oplus \Gamma^{E_{1g}} \oplus \Gamma^{E_{2u}}\]

<p>At the same time, we can generate the basis (i.e the symmetry adapted orbital ) of irredudible space \(V^{\mu}\) using project operator</p>

<p>\(\mathbf{P}^\mu= \sum_{R} \chi^{\mu}(R) \mathbf{O}(R)\)</p>
<h3 id="symmetry-in-molpro-and-orca">symmetry in molpro and orca</h3>
<p>Most of quantum chemistry software only support Abelian group.</p>

<p>The largest Abelian subgroup of \(D_{6h}\) is \(D_{2h}\).We need to find the correlation between irreps of this two groups.
One website which I find very useful is <a href="http://www.gernot-katzers-spice-pages.com/character_tables/D6h.html">gernot katezers</a>
<img src="/image/benzene/D6h_2_D2h.png" alt="Coorelation" /></p>

<p>Thus the irreps of our active space should become</p>

<p>\(B_{1u}, B_{2g}, B_{2g}+B_{3g},A_{u}+B_{1u}\)</p>
<h4 id="molpro">molpro</h4>
<p>In molpro the order of irreps is 
<img src="/image/benzene/order.png" alt="order" /></p>
<h2 id="ground-state">Ground State</h2>

<p>The strucutre of groud state benzene  is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="mi">12</span>
</span><span class="hll">
</span><span class="n">c</span> <span class="mf">2.27707173737953</span> <span class="o">-</span><span class="mf">1.31466798054016</span> <span class="mf">0.00000000000000</span>
<span class="n">c</span>  <span class="mf">2.27707173737953</span> <span class="mf">1.31466798054016</span> <span class="mf">0.00000000000000</span> 
<span class="n">c</span>  <span class="mf">0.00000000000000</span> <span class="mf">2.62933596108032</span> <span class="mf">0.00000000000000</span> 
<span class="n">c</span> <span class="o">-</span><span class="mf">2.27707173737953</span> <span class="mf">1.31466798054016</span> <span class="mf">0.00000000000000</span>
<span class="n">c</span> <span class="o">-</span><span class="mf">2.27707173737953</span> <span class="o">-</span><span class="mf">1.31466798054016</span> <span class="mf">0.0000000000000</span>
<span class="n">c</span> <span class="mf">0.00000000000000</span> <span class="o">-</span><span class="mf">2.62933596108032</span> <span class="mf">0.00000000000000</span>
<span class="n">h</span> <span class="mf">4.04988201744309</span> <span class="o">-</span><span class="mf">2.33820047295699</span> <span class="mf">0.00000000000000</span>
<span class="n">h</span>  <span class="mf">4.04988201744309</span> <span class="mf">2.33820047295699</span> <span class="mf">0.00000000000000</span> 
<span class="n">h</span>  <span class="mf">0.00000000000000</span> <span class="mf">4.67640094591398</span> <span class="mf">0.00000000000000</span> 
<span class="n">h</span> <span class="o">-</span><span class="mf">4.04988201744309</span> <span class="mf">2.33820047295699</span> <span class="mf">0.00000000000000</span>
<span class="n">h</span> <span class="o">-</span><span class="mf">4.04988201744309</span> <span class="o">-</span><span class="mf">2.33820047295699</span> <span class="mf">0.0000000000000</span>
<span class="n">h</span> <span class="mf">0.00000000000000</span> <span class="o">-</span><span class="mf">4.67640094591398</span> <span class="mf">0.00000000000000</span></code></pre></figure>

<h3 id="molpro-1">molpro</h3>
<p>The input of molpro is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">gprint</span> <span class="p">,</span><span class="n">civector</span>
</span><span class="hll"><span class="n">basis</span><span class="o">=</span><span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span>
</span><span class="n">bohr</span>
<span class="n">geometry</span><span class="o">=</span><span class="n">benzenex</span><span class="p">.</span><span class="nf">xyz</span>
<span class="p">{</span><span class="no">HF</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">hf</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span><span class="n">multi</span><span class="p">,</span>
<span class="n">occ</span>  <span class="mi">6</span>   <span class="mi">4</span>   <span class="mi">5</span>   <span class="mi">3</span>   <span class="mi">2</span>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">1</span><span class="p">;</span>
<span class="n">closed</span> <span class="mi">6</span>   <span class="mi">4</span>   <span class="mi">5</span>   <span class="mi">3</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="p">;</span>
<span class="n">wf</span><span class="p">,</span><span class="n">elec</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sym</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="n">rotate</span> <span class="mf">4.7</span> <span class="mf">2.7</span><span class="p">,</span><span class="mi">90</span>
<span class="n">rotate</span> <span class="mf">3.5</span> <span class="mf">2.5</span><span class="p">,</span><span class="mi">90</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">casscf</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span><span class="no">RS2</span><span class="o">-</span><span class="no">F12</span><span class="p">,</span><span class="n">shift</span><span class="o">=</span><span class="mf">0.2</span><span class="p">;</span>
<span class="n">wf</span><span class="p">,</span><span class="n">symmetry</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<h4 id="summary">Summary</h4>
<ol>
  <li>The active space is six corbon pz orbitals.</li>
  <li>spin is singlet</li>
  <li>wavefunction spatial symmetry is Ag</li>
  <li>but the active space is</li>
</ol>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> <span class="no">Number</span> <span class="n">of</span> <span class="n">active</span>  <span class="ss">orbitals:        </span><span class="mi">6</span> <span class="p">(</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">2</span>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">1</span> <span class="p">)</span>
</span></code></pre></figure>

<p><mark>
this has 2 $$B_{3g}$$ irreps instead of 2 $$B_{2g}$$ irreps
</mark></p>
<h3 id="orca">orca</h3>
<p>The input of orca is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="o">!</span><span class="no">HF</span>  <span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span> <span class="no">Usesym</span>   <span class="n">bohrs</span> 
</span><span class="hll"><span class="o">*</span><span class="n">xyzfile</span>  <span class="mi">0</span> <span class="mi">1</span>  <span class="n">benzenex</span><span class="p">.</span><span class="nf">xyz</span>
</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="o">!</span><span class="no">HF</span>  <span class="n">autoaux</span> <span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span> <span class="no">Usesym</span>   <span class="n">bohrs</span>
</span><span class="hll"><span class="o">!</span><span class="n">moread</span>
</span><span class="o">%</span><span class="n">moinp</span> <span class="s2">"hf.gbw"</span>
<span class="o">%</span><span class="n">basis</span>
 <span class="no">Basis</span> <span class="s2">"cc-pVDZ-F12"</span>
 <span class="no">CABS</span>  <span class="s2">"cc-pVDZ-F12-OptRI"</span>
<span class="k">end</span>

<span class="sx">% scf </span>
  <span class="n">rotate</span> 
        <span class="p">{</span><span class="mi">16</span><span class="p">,</span><span class="mi">18</span><span class="p">,</span><span class="mi">90</span><span class="p">}</span>
        <span class="p">{</span><span class="mi">21</span><span class="p">,</span><span class="mi">28</span><span class="p">,</span><span class="mi">90</span><span class="p">}</span>
        <span class="p">{</span><span class="mi">22</span><span class="p">,</span><span class="mi">29</span><span class="p">,</span><span class="mi">90</span><span class="p">}</span>
        <span class="p">{</span><span class="mi">23</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">90</span><span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="o">%</span><span class="n">casscf</span> 
   <span class="n">nel</span> <span class="mi">6</span>
   <span class="n">norb</span> <span class="mi">6</span>
   <span class="no">TrafoStep</span> <span class="no">RI</span>
   <span class="no">PTMethod</span>  <span class="no">FIC_NEVPT2</span>
   <span class="no">PTSettings</span> 
         <span class="no">F12</span> <span class="kp">true</span>
   <span class="k">end</span>
<span class="k">end</span> 
<span class="o">*</span><span class="n">xyzfile</span> <span class="mi">0</span> <span class="mi">1</span>  <span class="n">benzenex</span><span class="p">.</span><span class="nf">xyz</span></code></pre></figure>

<h3 id="result">Result</h3>
<p>The output of molpro is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll">         <span class="no">RS2</span><span class="o">-</span><span class="no">F12</span>           <span class="no">MULTI</span>          <span class="no">HF</span><span class="o">-</span><span class="no">SCF</span>
</span><span class="hll">   <span class="o">-</span><span class="mf">231.81401165</span>   <span class="o">-</span><span class="mf">230.84208086</span>   <span class="o">-</span><span class="mf">230.77066786</span>
</span></code></pre></figure>

<p>The output of orca is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> <span class="o">---------------------------------------------------------------</span> 
</span><span class="hll"> 	 <span class="no">Total</span> <span class="no">Energy</span> <span class="no">Correction</span> <span class="p">:</span> <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.97521870880607</span>
</span> <span class="o">---------------------------------------------------------------</span> 
 	 <span class="no">Reference</span>  <span class="no">Energy</span>       <span class="p">:</span> <span class="no">E0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">230.85678671167923</span>
 <span class="o">---------------------------------------------------------------</span> 
 	 <span class="no">Total</span> <span class="no">Energy</span> <span class="p">(</span><span class="no">E0</span><span class="o">+</span><span class="n">dE</span><span class="p">)</span>    <span class="p">:</span> <span class="no">E</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">231.83200542048530</span>
 <span class="o">---------------------------------------------------------------</span> </code></pre></figure>

<h2 id="excited-state">Excited State</h2>
<p>Now we need to calculate  the excited state.
In excited state, the geometry is as following</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="mi">12</span>
</span><span class="hll">
</span><span class="no">C</span> <span class="mf">2.32729774090999</span> <span class="o">-</span><span class="mf">1.34366597719879</span> <span class="mf">0.0000000000000</span>
<span class="no">C</span> <span class="mf">2.32729774090999</span> <span class="mf">1.34366597719879</span> <span class="mf">0.00000000000000</span>
<span class="no">C</span> <span class="mf">0.00000000000000</span> <span class="mf">2.68733195439759</span> <span class="mf">0.00000000000000</span>
<span class="no">C</span> <span class="o">-</span><span class="mf">2.32729774090999</span> <span class="mf">1.34366597719879</span> <span class="mf">0.0000000000000</span>
<span class="no">C</span> <span class="o">-</span><span class="mf">2.32729774090999</span> <span class="o">-</span><span class="mf">1.34366597719879</span> <span class="mf">0.000000000000</span>
<span class="no">C</span> <span class="mf">0.00000000000000</span> <span class="o">-</span><span class="mf">2.68733195439759</span> <span class="mf">0.0000000000000</span>
<span class="no">H</span> <span class="mf">4.09658133834245</span> <span class="o">-</span><span class="mf">2.36516233844921</span> <span class="mf">0.0000000000000</span>
<span class="no">H</span> <span class="mf">4.09658133834245</span> <span class="mf">2.36516233844921</span> <span class="mf">0.00000000000000</span>
<span class="no">H</span> <span class="mf">0.00000000000000</span> <span class="mf">4.73032467689843</span> <span class="mf">0.00000000000000</span>
<span class="no">H</span> <span class="o">-</span><span class="mf">4.09658133834245</span> <span class="mf">2.36516233844921</span> <span class="mf">0.0000000000000</span>
<span class="no">H</span> <span class="o">-</span><span class="mf">4.09658133834245</span> <span class="o">-</span><span class="mf">2.36516233844921</span> <span class="mf">0.000000000000</span>
<span class="no">H</span> <span class="mf">0.00000000000000</span> <span class="o">-</span><span class="mf">4.73032467689843</span> <span class="mf">0.0000000000000</span></code></pre></figure>

<h3 id="irreps-of-state">irreps of state</h3>
<p>If we assume the dominant configuration is excitation from \(E_{1g}\) to \(E_{2u}\),
the irreps is 
\(E_{1g}\times E_{2u}=B_{1u}\oplus B_{2u}\oplus E_{1u}\)
The \(D_{6h}\) irrep \(B_{1u},B_{2u}\) correlated to \(D_2h}\) irreps \(B_{3u} B_{2u}\)
<mark>But we choose </mark> \(B_{2u}\)
\(B_{3u}\) cannot run ,there is no configuration .Why ???</p>
<h3 id="molpro-2">molpro</h3>
<p>input</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">gprint</span> <span class="p">,</span><span class="n">civector</span>
</span><span class="hll"><span class="n">basis</span><span class="o">=</span><span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span>
</span><span class="n">bohr</span>
<span class="n">geometry</span><span class="o">=</span><span class="n">benzeneb1u</span><span class="p">.</span><span class="nf">xyz</span>
<span class="p">{</span><span class="no">HF</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">hf</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span><span class="n">multi</span><span class="p">,</span>
<span class="n">occ</span>  <span class="mi">6</span>   <span class="mi">4</span>   <span class="mi">5</span>   <span class="mi">3</span>   <span class="mi">2</span>   <span class="mi">1</span>   <span class="mi">2</span>   <span class="mi">1</span><span class="p">;</span>
<span class="n">closed</span> <span class="mi">6</span>   <span class="mi">4</span>   <span class="mi">5</span>   <span class="mi">3</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span>   <span class="mi">0</span><span class="p">;</span>
<span class="n">wf</span><span class="p">,</span><span class="n">elec</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sym</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="n">rotate</span> <span class="mf">4.7</span> <span class="mf">2.7</span><span class="p">,</span><span class="mi">90</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">casscf</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span><span class="no">RS2</span><span class="o">-</span><span class="no">F12</span><span class="p">,</span><span class="n">shift</span><span class="o">=</span><span class="mf">0.2</span><span class="p">;</span>
<span class="n">wf</span><span class="p">,</span><span class="n">symmetry</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>output</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll">         <span class="no">RS2</span><span class="o">-</span><span class="no">F12</span>           <span class="no">MULTI</span>          <span class="no">HF</span><span class="o">-</span><span class="no">SCF</span>
</span><span class="hll">   <span class="o">-</span><span class="mf">231.65091798</span>   <span class="o">-</span><span class="mf">230.66581679</span>   <span class="o">-</span><span class="mf">230.76283816</span>
</span></code></pre></figure>

<h3 id="orca-1">orca</h3>

<p>The input of orca for casscf is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="o">!</span><span class="no">HF</span>  <span class="n">autoaux</span> <span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span> <span class="no">Usesym</span>   <span class="n">bohrs</span>
</span><span class="hll"><span class="o">!</span><span class="n">moread</span>
</span><span class="o">%</span><span class="n">moinp</span> <span class="s2">"hf.gbw"</span>
<span class="o">%</span><span class="n">basis</span>
 <span class="no">Basis</span> <span class="s2">"cc-pVDZ-F12"</span>
 <span class="no">CABS</span>  <span class="s2">"cc-pVDZ-F12-OptRI"</span>
<span class="k">end</span>

<span class="sx">% scf </span>
  <span class="n">rotate</span> 
        <span class="p">{</span><span class="mi">21</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">90</span><span class="p">}</span>
        <span class="p">{</span><span class="mi">22</span><span class="p">,</span><span class="mi">27</span><span class="p">,</span><span class="mi">90</span><span class="p">}</span>
        <span class="p">{</span><span class="mi">23</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">90</span><span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="o">%</span><span class="n">casscf</span> 
   <span class="n">mult</span> <span class="mi">1</span> 
   <span class="n">irrep</span> <span class="mi">7</span>
   <span class="n">weights</span> <span class="mf">0.0</span> <span class="mf">1.0</span>  
   <span class="n">nel</span> <span class="mi">6</span>
   <span class="n">norb</span> <span class="mi">6</span>
   <span class="no">TrafoStep</span> <span class="no">RI</span>
   <span class="no">PTMethod</span>  <span class="no">FIC_NEVPT2</span>
   <span class="no">PTSettings</span> 
         <span class="no">F12</span> <span class="kp">true</span>
   <span class="k">end</span>
<span class="k">end</span> 
<span class="o">*</span><span class="n">xyzfile</span> <span class="mi">0</span> <span class="mi">1</span>  <span class="n">benzeneb1u</span><span class="p">.</span><span class="nf">xyz</span></code></pre></figure>

<p>output is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> <span class="no">Symmetries</span> <span class="n">of</span> <span class="n">active</span> <span class="ss">orbitals:</span>
</span><span class="hll"><span class="ss">   </span><span class="no">MO</span> <span class="o">=</span>   <span class="mi">18</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">5</span> <span class="p">(</span><span class="no">B1u</span><span class="p">)</span>
</span>   <span class="no">MO</span> <span class="o">=</span>   <span class="mi">19</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">3</span> <span class="p">(</span><span class="no">B3g</span><span class="p">)</span>
   <span class="no">MO</span> <span class="o">=</span>   <span class="mi">20</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">2</span> <span class="p">(</span><span class="no">B2g</span><span class="p">)</span>
   <span class="no">MO</span> <span class="o">=</span>   <span class="mi">21</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">5</span> <span class="p">(</span><span class="no">B1u</span><span class="p">)</span>
   <span class="no">MO</span> <span class="o">=</span>   <span class="mi">22</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">4</span> <span class="p">(</span><span class="no">Au</span><span class="p">)</span>
   <span class="no">MO</span> <span class="o">=</span>   <span class="mi">23</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">3</span> <span class="p">(</span><span class="no">B3g</span><span class="p">)</span>
<span class="o">--------------</span>
<span class="no">CASSCF</span> <span class="no">RESULTS</span>
<span class="o">--------------</span>

<span class="no">Final</span> <span class="no">CASSCF</span> <span class="n">energy</span>       <span class="p">:</span> <span class="o">-</span><span class="mf">230.665821065</span> <span class="no">Eh</span>   <span class="o">-</span><span class="mf">6276.7361</span> <span class="n">eV</span></code></pre></figure>

<p>Finally the  f12 result is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> 	 <span class="no">Total</span> <span class="no">Energy</span> <span class="no">Correction</span> <span class="p">:</span> <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.96437097091322</span>
</span><span class="hll"> <span class="o">---------------------------------------------------------------</span> 
</span> 	 <span class="no">Reference</span>  <span class="no">Energy</span>       <span class="p">:</span> <span class="no">E0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">230.67968019252493</span>
 <span class="o">---------------------------------------------------------------</span> 
 	 <span class="no">Total</span> <span class="no">Energy</span> <span class="p">(</span><span class="no">E0</span><span class="o">+</span><span class="n">dE</span><span class="p">)</span>    <span class="p">:</span> <span class="no">E</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">231.64405116343815</span>
 <span class="o">---------------------------------------------------------------</span></code></pre></figure>

<h2 id="conclusion">Conclusion</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1. The state symmetry include ,spin symmetry ,spatial symmetry .After determinant this ,we also need to specify which root is want we want.
2. the state symmetry is determinat from direct product of orbital. 
</code></pre></div></div>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background Here we want to calculate the adiabatic excitation energy of benzene. For introduction and the source of sturcture ,see previous postcalculation of acetylene]]></summary></entry><entry><title type="html">Calculation of C2H2 methylene</title><link href="http://localhost:4000/jekyll/update/2025/05/19/calculation-gallary.html" rel="alternate" type="text/html" title="Calculation of C2H2 methylene" /><published>2025-05-19T17:13:29+08:00</published><updated>2025-05-19T17:13:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/05/19/calculation-gallary</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/05/19/calculation-gallary.html"><![CDATA[<p>Here we want to calculate the adiabatic excitation energy of C2H2</p>

<h2 id="background">Background</h2>
<p><img src="/image/c2cs35394f-f1.gif" alt="AltText" /></p>

<p>The difference between vertical adiabatic and 0-0 exciation energy can be found at  this paper
“dx.doi.org/10.1021/jp501974p | J. Phys. Chem. A 2014, 118, 4157−4171”</p>

<p>The structure of single is optimized using dft ,taken from si of this paper
“dx.doi.org/10.1021/ct200272b | J. Chem. Theory Comput. 2011, 7, 2376–2386”</p>

<p>In this post ,we want to calculate the adiabatic excitateion energy  of Acetylene
of caspt2-f12 and nevpt2-f12 in molpro and orca respectivly.</p>

<h2 id="ground-state">Ground State</h2>

<p>The strucutre of methylene is linear</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="mi">4</span>
</span><span class="hll">
</span><span class="n">c</span> <span class="mf">0.00000000000000</span> <span class="mf">0.00000000000000</span> <span class="mf">1.13109775801047</span> 
<span class="n">c</span> <span class="mf">0.00000000000000</span> <span class="mf">0.00000000000000</span> <span class="o">-</span><span class="mf">1.13109775801047</span> 
<span class="n">h</span> <span class="mf">0.00000000000000</span> <span class="mf">0.00000000000000</span> <span class="mf">3.13996154221094</span> 
<span class="n">h</span> <span class="mf">0.00000000000000</span> <span class="mf">0.00000000000000</span> <span class="o">-</span><span class="mf">3.13996154221094</span> </code></pre></figure>

<h3 id="molpro">molpro</h3>
<p>The input of molpro is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">gprint</span><span class="p">,</span><span class="n">orbitals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">civector</span>
</span><span class="hll"><span class="n">basis</span><span class="o">=</span><span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span>
</span><span class="n">bohr</span>
<span class="n">geometry</span><span class="o">=</span><span class="no">C2H2X</span><span class="p">.</span><span class="nf">xyz</span>
<span class="p">{</span><span class="no">HF</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">hf</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span><span class="n">multi</span><span class="p">,</span>
<span class="n">occ</span>  <span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span> <span class="p">;</span>
<span class="n">closed</span>  <span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">;</span> 
<span class="n">wf</span><span class="p">,</span><span class="n">elec</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sym</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="o">!</span><span class="n">rotate</span> <span class="mf">4.1</span><span class="p">,</span><span class="mf">6.1</span><span class="p">,</span><span class="mi">90</span>
<span class="o">!</span><span class="n">rotate</span> <span class="mf">3.5</span><span class="p">,</span><span class="mf">6.5</span><span class="p">,</span><span class="mi">90</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">cas</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span><span class="no">RS2</span><span class="o">-</span><span class="no">F12</span><span class="p">,</span><span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">wf</span><span class="p">,</span><span class="n">symmetry</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<h4 id="summary">Summary</h4>
<ol>
  <li>The active space is C(2p) orbital,and we need to find two pi-bond orbital and two pi-antibond orbital.</li>
  <li>The geomerty is linear</li>
  <li>spin is singlet</li>
  <li>wavefunction spatial symmetry is Ag
    <h3 id="orca">orca</h3>
    <p>The input of orca is</p>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="o">!</span><span class="no">HF</span>  <span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span> <span class="no">Usesym</span>   <span class="n">bohrs</span> <span class="n">largeprint</span> 
</span><span class="hll"><span class="o">*</span><span class="n">xyzfile</span>  <span class="mi">0</span> <span class="mi">1</span>  <span class="no">C2H2X</span><span class="p">.</span><span class="nf">xyz</span>
</span></code></pre></figure>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="o">!</span><span class="no">HF</span>  <span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span> <span class="no">Usesym</span>   <span class="n">bohrs</span>
</span><span class="hll"><span class="o">!</span><span class="n">moread</span>
</span><span class="o">%</span><span class="n">moinp</span> <span class="s2">"HF.gbw"</span>
<span class="sx">% scf </span>
  <span class="n">rotate</span> 
        <span class="p">{</span><span class="mi">6</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">90</span><span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="o">%</span><span class="n">casscf</span> 
   <span class="n">nel</span> <span class="mi">4</span>
   <span class="n">norb</span> <span class="mi">4</span>
   <span class="no">PTMethod</span> <span class="n">fic_nevpt2</span>
   <span class="n">ptsettings</span>
     <span class="n">f12</span> <span class="kp">true</span>
   <span class="k">end</span>
   
<span class="k">end</span> 
<span class="o">*</span><span class="n">xyz</span>  <span class="mi">0</span> <span class="mi">1</span>  
<span class="n">c</span> <span class="mf">0.00000000000000</span> <span class="mf">0.00000000000000</span> <span class="mf">1.13109775801047</span> 
<span class="n">c</span> <span class="mf">0.00000000000000</span> <span class="mf">0.00000000000000</span> <span class="o">-</span><span class="mf">1.13109775801047</span> 
<span class="n">h</span> <span class="mf">0.00000000000000</span> <span class="mf">0.00000000000000</span> <span class="mf">3.13996154221094</span> 
<span class="n">h</span> <span class="mf">0.00000000000000</span> <span class="mf">0.00000000000000</span> <span class="o">-</span><span class="mf">3.13996154221094</span> 
<span class="o">*</span></code></pre></figure>

<h3 id="result">Result</h3>
<p>The output of molpro is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll">         <span class="no">RS2</span><span class="o">-</span><span class="no">F12</span>           <span class="no">MULTI</span>          <span class="no">HF</span><span class="o">-</span><span class="no">SCF</span>
</span><span class="hll">    <span class="o">-</span><span class="mf">77.18737976</span>    <span class="o">-</span><span class="mf">76.91519896</span>    <span class="o">-</span><span class="mf">76.84728822</span>
</span></code></pre></figure>

<p>The output of orca is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> <span class="o">===============================================================</span>
</span><span class="hll">                       <span class="no">NEVPT2</span> <span class="no">Results</span>  
</span> <span class="o">===============================================================</span>
   <span class="o">*******************************</span>
    <span class="no">MULT</span> <span class="mi">1</span><span class="p">,</span> <span class="no">IRREP</span>  <span class="no">Ag</span><span class="p">,</span> <span class="no">ROOT</span> <span class="mi">0</span> 
   <span class="o">*******************************</span>

  <span class="no">Class</span> <span class="no">V0_ijab</span> <span class="p">:</span>	 <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.067841971472</span> 
  <span class="no">Class</span> <span class="no">Vm1_iab</span> <span class="p">:</span>	 <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.061599918270</span> 
  <span class="no">Class</span> <span class="no">Vm2_ab</span>  <span class="p">:</span>	 <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.026472162485</span> 
  <span class="no">Class</span> <span class="no">V1_ija</span>  <span class="p">:</span>	 <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.008119245188</span> 
  <span class="no">Class</span> <span class="no">V2_ij</span>   <span class="p">:</span>	 <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.001871859387</span> 
  <span class="no">Class</span> <span class="no">V0_ia</span>   <span class="p">:</span>	 <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.050330027838</span> 
  <span class="no">Class</span> <span class="no">Vm1_a</span>   <span class="p">:</span>	 <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.001943111619</span> 
  <span class="no">Class</span> <span class="no">V1_i</span>    <span class="p">:</span>	 <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.000000000000</span> 

 <span class="o">---------------------------------------------------------------</span> 
 	 <span class="no">Total</span> <span class="no">Energy</span> <span class="no">Correction</span> <span class="p">:</span> <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.21817829625785</span>
 <span class="o">---------------------------------------------------------------</span> 
 	 <span class="no">Reference</span>  <span class="no">Energy</span>       <span class="p">:</span> <span class="no">E0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">76.91519884161944</span>
 <span class="o">---------------------------------------------------------------</span> 
 	 <span class="no">Total</span> <span class="no">Energy</span> <span class="p">(</span><span class="no">E0</span><span class="o">+</span><span class="n">dE</span><span class="p">)</span>    <span class="p">:</span> <span class="no">E</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">77.13337713787729</span>
 <span class="o">---------------------------------------------------------------</span> </code></pre></figure>

<h2 id="excited-state">Excited State</h2>
<p>Now we need to calculate  the excited state.
In excited state, the geometry is as following 
<img src="/image/excited_state.png" alt="AltText" /></p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="mi">4</span>
</span><span class="hll">
</span><span class="n">c</span> <span class="o">-</span><span class="mf">0.22872949141251</span> <span class="mf">1.27002027174688</span> <span class="o">-</span><span class="mf">0.00000000311696</span> 
<span class="n">c</span> <span class="mf">0.22872960517416</span> <span class="o">-</span><span class="mf">1.27002040888460</span> <span class="o">-</span><span class="mf">0.00000000311917</span> 
<span class="n">h</span> <span class="mf">1.29544929136450</span> <span class="mf">2.67207978087269</span> <span class="mf">0.00000003715195</span> 
<span class="n">h</span> <span class="o">-</span><span class="mf">1.29545064696851</span> <span class="o">-</span><span class="mf">2.67207814671517</span> <span class="mf">0.00000003715897</span> </code></pre></figure>

<h3 id="molpro-1">molpro</h3>
<p>In molpro the point group of excited state is denoted to be Cs
input</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">gprint</span><span class="p">,</span><span class="n">orbitals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">civector</span>
</span><span class="hll"><span class="n">basis</span><span class="o">=</span><span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span>
</span><span class="n">bohr</span>
<span class="n">geometry</span><span class="o">=</span><span class="no">C2H2A1</span><span class="p">.</span><span class="nf">xyz</span>
<span class="p">{</span><span class="no">HF</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">hf</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span><span class="n">multi</span><span class="p">,</span>
<span class="n">occ</span>  <span class="mi">7</span><span class="p">,</span><span class="mi">2</span> <span class="p">;</span>
<span class="n">closed</span>  <span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">;</span> 
<span class="n">wf</span><span class="p">,</span><span class="n">elec</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sym</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span>
<span class="n">state</span> <span class="mi">2</span><span class="p">;</span>
<span class="n">weight</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">cas</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span><span class="no">RS2</span><span class="o">-</span><span class="no">F12</span><span class="p">,</span><span class="n">shift</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="n">wf</span><span class="p">,</span><span class="n">symmetry</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre></figure>

<p>output</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> <span class="no">RS2</span><span class="o">-</span><span class="no">F12</span><span class="o">/</span><span class="n">cc</span><span class="o">-</span><span class="n">pVDZ</span><span class="o">-</span><span class="no">F12</span> <span class="n">energy</span><span class="o">=</span>    <span class="o">-</span><span class="mf">76.999081928598</span>
</span><span class="hll">
</span>         <span class="no">RS2</span><span class="o">-</span><span class="no">F12</span>           <span class="no">MULTI</span>          <span class="no">HF</span><span class="o">-</span><span class="no">SCF</span>
    <span class="o">-</span><span class="mf">76.99908193</span>    <span class="o">-</span><span class="mf">76.69704216</span>    <span class="o">-</span><span class="mf">76.75296781</span></code></pre></figure>

<h3 id="orca-1">orca</h3>
<p>In orca the point group of excited state is determinated to be C2h which is correct.
After HF we need to find the order of mos of four pi-bond and pi-antibond orbital</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="o">----------------</span>
</span><span class="hll"><span class="no">ORBITAL</span> <span class="no">ENERGIES</span>
</span><span class="o">----------------</span>

  <span class="no">NO</span>   <span class="no">OCC</span>          <span class="no">E</span><span class="p">(</span><span class="no">Eh</span><span class="p">)</span>            <span class="no">E</span><span class="p">(</span><span class="n">eV</span><span class="p">)</span>    <span class="no">Irrep</span> 
   <span class="mi">0</span>   <span class="mf">2.0000</span>     <span class="o">-</span><span class="mf">11.296779</span>      <span class="o">-</span><span class="mf">307.4010</span>    <span class="mi">1</span><span class="o">-</span><span class="no">Ag</span>
   <span class="mi">1</span>   <span class="mf">2.0000</span>     <span class="o">-</span><span class="mf">11.295308</span>      <span class="o">-</span><span class="mf">307.3610</span>    <span class="mi">1</span><span class="o">-</span><span class="no">Bu</span>
   <span class="mi">2</span>   <span class="mf">2.0000</span>      <span class="o">-</span><span class="mf">1.012950</span>       <span class="o">-</span><span class="mf">27.5638</span>    <span class="mi">2</span><span class="o">-</span><span class="no">Ag</span>
   <span class="mi">3</span>   <span class="mf">2.0000</span>      <span class="o">-</span><span class="mf">0.765920</span>       <span class="o">-</span><span class="mf">20.8417</span>    <span class="mi">2</span><span class="o">-</span><span class="no">Bu</span>
   <span class="mi">4</span>   <span class="mf">2.0000</span>      <span class="o">-</span><span class="mf">0.596013</span>       <span class="o">-</span><span class="mf">16.2183</span>    <span class="mi">3</span><span class="o">-</span><span class="no">Ag</span>
   <span class="mi">5</span>   <span class="mf">2.0000</span>      <span class="o">-</span><span class="mf">0.417948</span>       <span class="o">-</span><span class="mf">11.3729</span>    <span class="mi">3</span><span class="o">-</span><span class="no">Bu</span>
   <span class="mi">6</span>   <span class="mf">2.0000</span>      <span class="o">-</span><span class="mf">0.386648</span>       <span class="o">-</span><span class="mf">10.5212</span>    <span class="mi">1</span><span class="o">-</span><span class="no">Au</span>
   <span class="mi">7</span>   <span class="mf">0.0000</span>       <span class="mf">0.020162</span>         <span class="mf">0.5486</span>    <span class="mi">4</span><span class="o">-</span><span class="no">Ag</span>
   <span class="mi">8</span>   <span class="mf">0.0000</span>       <span class="mf">0.060384</span>         <span class="mf">1.6431</span>    <span class="mi">4</span><span class="o">-</span><span class="no">Bu</span>
   <span class="mi">9</span>   <span class="mf">0.0000</span>       <span class="mf">0.081533</span>         <span class="mf">2.2186</span>    <span class="mi">5</span><span class="o">-</span><span class="no">Ag</span>
  <span class="mi">10</span>   <span class="mf">0.0000</span>       <span class="mf">0.090870</span>         <span class="mf">2.4727</span>    <span class="mi">1</span><span class="o">-</span><span class="no">Bg</span>
  <span class="mi">11</span>   <span class="mf">0.0000</span>       <span class="mf">0.091065</span>         <span class="mf">2.4780</span>    <span class="mi">5</span><span class="o">-</span><span class="no">Bu</span>
  <span class="mi">12</span>   <span class="mf">0.0000</span>       <span class="mf">0.101260</span>         <span class="mf">2.7554</span>    <span class="mi">2</span><span class="o">-</span><span class="no">Au</span>
  <span class="mi">13</span>   <span class="mf">0.0000</span>       <span class="mf">0.129303</span>         <span class="mf">3.5185</span>    <span class="mi">6</span><span class="o">-</span><span class="no">Ag</span>
  <span class="mi">14</span>   <span class="mf">0.0000</span>       <span class="mf">0.137025</span>         <span class="mf">3.7286</span>    <span class="mi">7</span><span class="o">-</span><span class="no">Ag</span></code></pre></figure>

<p>The orbital in active space is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll">   <span class="mi">5</span>   <span class="mf">2.0000</span>      <span class="o">-</span><span class="mf">0.417948</span>       <span class="o">-</span><span class="mf">11.3729</span>    <span class="mi">3</span><span class="o">-</span><span class="no">Bu</span>
</span><span class="hll">   <span class="mi">6</span>   <span class="mf">2.0000</span>      <span class="o">-</span><span class="mf">0.386648</span>       <span class="o">-</span><span class="mf">10.5212</span>    <span class="mi">1</span><span class="o">-</span><span class="no">Au</span>
</span>   <span class="mi">7</span>   <span class="mf">0.0000</span>       <span class="mf">0.020162</span>         <span class="mf">0.5486</span>    <span class="mi">4</span><span class="o">-</span><span class="no">Ag</span>
  <span class="mi">10</span>   <span class="mf">0.0000</span>       <span class="mf">0.090870</span>         <span class="mf">2.4727</span>    <span class="mi">1</span><span class="o">-</span><span class="no">Bg</span></code></pre></figure>

<p>First we need to rotate the group of {8,10}</p>

<p>Next the excitation is from 6–&gt;7</p>

<p>The symmetry is Au X Ag = Au</p>

<p>The input of orca for casscf is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="o">!</span><span class="no">HF</span>  <span class="n">cc</span><span class="o">-</span><span class="n">pvdz</span><span class="o">-</span><span class="n">f12</span> <span class="no">Usesym</span>   <span class="n">bohrs</span>
</span><span class="hll"><span class="o">!</span><span class="n">moread</span>
</span><span class="o">%</span><span class="n">moinp</span> <span class="s2">"HF.gbw"</span>
<span class="sx">% scf </span>
  <span class="n">rotate</span> 
        <span class="p">{</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">90</span><span class="p">}</span>
  <span class="k">end</span>
<span class="k">end</span>
<span class="o">%</span><span class="n">casscf</span> 
   <span class="n">nel</span> <span class="mi">4</span>
   <span class="n">norb</span> <span class="mi">4</span>
   <span class="n">mult</span> <span class="mi">1</span>
   <span class="n">irrep</span>  <span class="mi">2</span> 
   <span class="n">nroots</span> <span class="mi">1</span>
<span class="c1">#   PTMethod fic_nevpt2</span>
<span class="c1">#   ptsettings</span>
<span class="c1">#     f12 true</span>
<span class="c1">#   end</span>
   
<span class="k">end</span> 
<span class="o">*</span><span class="n">xyzfile</span>  <span class="mi">0</span> <span class="mi">1</span>  <span class="no">C2H2A1</span><span class="p">.</span><span class="nf">xyz</span></code></pre></figure>

<p>output is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> <span class="no">Symmetries</span> <span class="n">of</span> <span class="n">active</span> <span class="ss">orbitals:</span>
</span><span class="hll"><span class="ss">   </span><span class="no">MO</span> <span class="o">=</span>    <span class="mi">5</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">3</span> <span class="p">(</span><span class="no">Bu</span><span class="p">)</span>
</span>   <span class="no">MO</span> <span class="o">=</span>    <span class="mi">6</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">2</span> <span class="p">(</span><span class="no">Au</span><span class="p">)</span>
   <span class="no">MO</span> <span class="o">=</span>    <span class="mi">7</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">0</span> <span class="p">(</span><span class="no">Ag</span><span class="p">)</span>
   <span class="no">MO</span> <span class="o">=</span>    <span class="mi">8</span>  <span class="no">IRREP</span><span class="o">=</span> <span class="mi">1</span> <span class="p">(</span><span class="no">Bg</span><span class="p">)</span>
<span class="o">-------------------------</span>   <span class="o">--------------------</span>
<span class="no">FINAL</span> <span class="no">SINGLE</span> <span class="no">POINT</span> <span class="no">ENERGY</span>       <span class="o">-</span><span class="mf">76.697042114451</span>
<span class="o">-------------------------</span>   <span class="o">--------------------</span></code></pre></figure>

<p>Finally the  f12 result is</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> <span class="o">---------------------------------------------------------------</span> 
</span><span class="hll"> 	 <span class="no">Total</span> <span class="no">Energy</span> <span class="no">Correction</span> <span class="p">:</span> <span class="n">dE</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.24327214974453</span>
</span> <span class="o">---------------------------------------------------------------</span> 
 	 <span class="no">Reference</span>  <span class="no">Energy</span>       <span class="p">:</span> <span class="no">E0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">76.69704211445088</span>
 <span class="o">---------------------------------------------------------------</span> 
 	 <span class="no">Total</span> <span class="no">Energy</span> <span class="p">(</span><span class="no">E0</span><span class="o">+</span><span class="n">dE</span><span class="p">)</span>    <span class="p">:</span> <span class="no">E</span>  <span class="o">=</span> <span class="o">-</span><span class="mf">76.94031426419541</span>
 <span class="o">---------------------------------------------------------------</span> </code></pre></figure>

<h2 id="conclusion">Conclusion</h2>
<ol>
  <li>First of all ,the active space is important. I first think the active space should be C-H sigma bond, but this is not correct .
The correct active space is pi bond.</li>
  <li>
    <p>The spatial symmetry of the excited state I implicitly is choosen to be the same of ground state. But the correct way to determinate is</p>

    <p>a. choose the correct point group</p>

    <p>b. check the active space MO irreps</p>

    <p>c. determinate the excitation type ,and thus determinate the dominant configuration of the excited state you want.</p>

    <p>d. the correct state symmetry is to be the direct product of  single occupied acitive space orbital.</p>
  </li>
</ol>

<p>Need to check all input parameter !!!</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Here we want to calculate the adiabatic excitation energy of C2H2]]></summary></entry><entry><title type="html">Theory of DSRG-PT2</title><link href="http://localhost:4000/jekyll/update/2025/04/26/welcome-to-jekyll.html" rel="alternate" type="text/html" title="Theory of DSRG-PT2" /><published>2025-04-26T22:13:29+08:00</published><updated>2025-04-26T22:13:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/04/26/welcome-to-jekyll</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/04/26/welcome-to-jekyll.html"><![CDATA[<p>This site my can host some learning material in my life.
<code class="language-plaintext highlighter-rouge">YEAR-MONTH-DAY-title.MARKUP</code></p>

<p>Where <code class="language-plaintext highlighter-rouge">YEAR</code> is a four-digit number, <code class="language-plaintext highlighter-rouge">MONTH</code> and <code class="language-plaintext highlighter-rouge">DAY</code> are both two-digit numbers, and <code class="language-plaintext highlighter-rouge">MARKUP</code> is the file extension representing the format used in the file. After that, include the necessary front matter. Take a look at the source for this post to get an idea about how it works.</p>

<p>Jekyll also offers powerful support for code snippets:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">print_hi</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
  <span class="n">puts</span> <span class="sh">"</span><span class="s">Hi, #{name}</span><span class="sh">"</span>
<span class="n">end</span>
<span class="nf">print_hi</span><span class="p">(</span><span class="sh">'</span><span class="s">Tom</span><span class="sh">'</span><span class="p">)</span>
<span class="c1">#=&gt; prints 'Hi, Tom' to STDOUT.</span></code></pre></figure>

<p>There is an equation
\(E=mcd^2\)
Check out the <a href="https://github.com/docs/home">Forte</a> for more info on how to get the most out of Jekyll. File all bugs/feature requests at <a href="https://github.com/jekyll/jekyll">Jekyll’s GitHub repo</a>. If you have questions, you can ask them on <a href="https://talk.jekyllrb.com/">Jekyll Talk</a>.</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[This site my can host some learning material in my life. YEAR-MONTH-DAY-title.MARKUP]]></summary></entry></feed>