<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.4.1">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2025-12-27T11:39:07+08:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">Garden Of Garbage</title><subtitle>a garden to log the garbage of my life</subtitle><entry><title type="html">Relationship between SRG and DSRG</title><link href="http://localhost:4000/jekyll/update/2025/12/24/srg.html" rel="alternate" type="text/html" title="Relationship between SRG and DSRG" /><published>2025-12-24T15:47:29+08:00</published><updated>2025-12-24T15:47:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/12/24/srg</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/12/24/srg.html"><![CDATA[<p>This is an introduction when I write an introduction ,but I decided to delete it. But this part is
what most intresting part of the whole theory in my eyes.So I keep it here for reminder.</p>
<h2 id="introduction">Introduction</h2>
<p>\par
DSRG has been motivated by the desire to realize the SRG transformation using a 
formalism similar to that of unitary CC theory\cite{Evangelista:2014kt,Li:2019fu}.
%% srg
Initially formulated by Wegner\cite{Wegner:1994kh} and by Glazek and Wilson\cite{Giazek:1993ik}, the SRG has been extensively applied in various areas of physics\cite{Xu2024b, Parzuchowski:2016vi, Morris2015}.
The essence of the SRG formalism is to perform a continuous unitary (similarity) transformation of the Hamiltonian to 
drive it to a diagonal or block-diagonal form.
\begin{equation}
H(s)=U^\dagger(s)HU(s) \implies \frac{dH(s)}{ds}=[\eta(s),H(s)]
\end{equation}
where \(s\in [0,\infty]\) is time-like flow parameter,and generator \(\eta(s)\equiv \frac{d U(s)^\dagger}{ds}U(s)\) implicitly defines the unitary transformation.
The SRG flow equation with the Wegner generator has the structure of a double bracket equation\cite{Helmke1994}. 
 \begin{equation}
 \eta=[H^d(s),H(s)] \implies dH=[[H^d(s),H(s)],H(s)]
 \end{equation}
where \(H^d\) is the defined “diagonal” parts of Hamiltonian.
In mathematical literature, this is recognized as a gradient flow on a manifold of unitary matrices\cite{BROCKETT199179}.
One of the most important features of the SRG transformation is its ability to separate energy scales in the Hamiltonian. 
A second-order perturbative analysis of the SRG flow reveals that the off-diagonal matrix elements decay exponentially with the flow parameter $s$:
\begin{equation}
    H_{ij}^{\text{od}}(s) \approx e^{-s \Delta_{ij}^2} H_{ij}^{\text{od}}(0),
\end{equation}
where \(H^{\text{od}}\) denotes the off-diagonal parts of the Hamiltonian, and \(\Delta_{ij} = H_{ii}^{d} - H_{jj}^{d}\) is the energy gap between the $i$-th and $j$-th diagonal (zeroth-order) states. 
This exponential damping suppresses couplings between states with large energy differences (\(|\Delta_{ij}| \gg 1/\sqrt{s}\)), while preserving couplings between quasidegenerate states (\(|\Delta_{ij}| \lesssim 1/\sqrt{s}\)).
However, the Wegner generator has a notable drawback: it produces a stiff set of ordinary differential equations (ODEs) due to the non-uniform decay rates of different off-diagonal elements.
To address this issue, alternative generators have been proposed. For instance, the White generator and the “imaginary time” generator induce uniform suppression of all off-diagonal elements.
\begin{equation}
    H_{ij}^{\text{od}}(s) \approx e^{-s} H_{ij}^{\text{od}}(0).
    \label{eq:uniform_decay}
\end{equation}
Another distinctive feature of the Wegner generator becomes apparent when examining the second-order correlation energy expression.</p>

<p>\begin{equation}
    E_i^{(2)}(s)=  \sum_{k\neq i } \frac{H_{ik}^2}{\Delta_{ik}} [ 1 - e^{-2s\Delta_{ik}^2} ]
\end{equation}</p>

<p>This expression can be viewed as a regularized generalization of ordinary Rayleigh–Schrödinger perturbation theory. The regularization factor \(\left[1 - e^{-2s\Delta_{ik}^2}\right]\) ensures that the energy remains finite even when two zeroth-order states become degenerate (\(\Delta_{ik} \rightarrow 0\)), thereby providing intrinsic protection against the intruder-state problem.
% dsrg
\par
The Driven Similarity Renormalization Group (DSRG) was initially formulated by Evangelista as an integrated version of the SRG formalism the continuous SRG flow\cite{Evangelista:2014kt}.
 DSRG employs a memory-less source operator \(\hat{R}(s)\) that drives the off-diagonal components of the Hamiltonian to zero as \(s \rightarrow \infty\).
This approach replaces the set of stiff ordinary differential equations in SRG with a system of algebraic equations that are solved at each value of the flow parameter $s$.
The DSRG parametrizes the unitary transformation using an anti-Hermitian operator , analogous to unitary coupled cluster theory.
\begin{equation}
    U(s)=e^{\hat A(s)} \quad \hat{A}(s) = \hat{T}(s) - \hat{T}^\dagger(s)
\end{equation}
The cluster operator \(\hat T(s)\) is determined by the many-body-condtion
\begin{equation}
    \hat H(s)^{od}=\hat R(s)
\end{equation}
Crucially, the source operator \(\hat{R}(s)\) is chosen to incorporate the same regularization factor as the SRG with the Wegner generators making the DSRG intrinsically protected against the intruder-state problem.
Soon after, Li and Evangelista presented a DSRG-MRPT\cite{Li:2015iz}, and the iterative multireference method MR-LDSRG(2)\cite{Li:2016hb},
where ‘L’ denotes “linearized” since only the linear commutator is evaluated and ‘(2)’ 
signals that only up to two-body operators are retained in the recursive linear commutator expansion.
Many application have show DSRG is very good \cite{Li2025,Zhao2025}.</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[This is an introduction when I write an introduction ,but I decided to delete it. But this part is what most intresting part of the whole theory in my eyes.So I keep it here for reminder. Introduction \par DSRG has been motivated by the desire to realize the SRG transformation using a formalism similar to that of unitary CC theory\cite{Evangelista:2014kt,Li:2019fu}. %% srg Initially formulated by Wegner\cite{Wegner:1994kh} and by Glazek and Wilson\cite{Giazek:1993ik}, the SRG has been extensively applied in various areas of physics\cite{Xu2024b, Parzuchowski:2016vi, Morris2015}. The essence of the SRG formalism is to perform a continuous unitary (similarity) transformation of the Hamiltonian to drive it to a diagonal or block-diagonal form. \begin{equation} H(s)=U^\dagger(s)HU(s) \implies \frac{dH(s)}{ds}=[\eta(s),H(s)] \end{equation} where \(s\in [0,\infty]\) is time-like flow parameter,and generator \(\eta(s)\equiv \frac{d U(s)^\dagger}{ds}U(s)\) implicitly defines the unitary transformation. The SRG flow equation with the Wegner generator has the structure of a double bracket equation\cite{Helmke1994}. \begin{equation} \eta=[H^d(s),H(s)] \implies dH=[[H^d(s),H(s)],H(s)] \end{equation} where \(H^d\) is the defined “diagonal” parts of Hamiltonian. In mathematical literature, this is recognized as a gradient flow on a manifold of unitary matrices\cite{BROCKETT199179}. One of the most important features of the SRG transformation is its ability to separate energy scales in the Hamiltonian. A second-order perturbative analysis of the SRG flow reveals that the off-diagonal matrix elements decay exponentially with the flow parameter $s$: \begin{equation} H_{ij}^{\text{od}}(s) \approx e^{-s \Delta_{ij}^2} H_{ij}^{\text{od}}(0), \end{equation} where \(H^{\text{od}}\) denotes the off-diagonal parts of the Hamiltonian, and \(\Delta_{ij} = H_{ii}^{d} - H_{jj}^{d}\) is the energy gap between the $i$-th and $j$-th diagonal (zeroth-order) states. This exponential damping suppresses couplings between states with large energy differences (\(|\Delta_{ij}| \gg 1/\sqrt{s}\)), while preserving couplings between quasidegenerate states (\(|\Delta_{ij}| \lesssim 1/\sqrt{s}\)). However, the Wegner generator has a notable drawback: it produces a stiff set of ordinary differential equations (ODEs) due to the non-uniform decay rates of different off-diagonal elements. To address this issue, alternative generators have been proposed. For instance, the White generator and the “imaginary time” generator induce uniform suppression of all off-diagonal elements. \begin{equation} H_{ij}^{\text{od}}(s) \approx e^{-s} H_{ij}^{\text{od}}(0). \label{eq:uniform_decay} \end{equation} Another distinctive feature of the Wegner generator becomes apparent when examining the second-order correlation energy expression.]]></summary></entry><entry><title type="html">MP2F12 implementaion</title><link href="http://localhost:4000/jekyll/update/2025/12/24/mp2f12.html" rel="alternate" type="text/html" title="MP2F12 implementaion" /><published>2025-12-24T15:47:29+08:00</published><updated>2025-12-24T15:47:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/12/24/mp2f12</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/12/24/mp2f12.html"><![CDATA[<p>This is a note about mp2f12</p>
<object data="/pdf/mp2f12.pdf" type="application/pdf" width="100%" height="600px">
   <p>the browser does not support PDFs. <a href="/pdf/mp2f12.pdf">Download the PDF</a>.</p>
 </object>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[This is a note about mp2f12 the browser does not support PDFs. Download the PDF.]]></summary></entry><entry><title type="html">VQE UCCSD ansatz</title><link href="http://localhost:4000/jekyll/update/2025/11/22/ucc.html" rel="alternate" type="text/html" title="VQE UCCSD ansatz" /><published>2025-11-22T22:13:29+08:00</published><updated>2025-11-22T22:13:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/11/22/ucc</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/11/22/ucc.html"><![CDATA[<h2 id="introduction">Introduction</h2>

<h2 id="do-scf-calculation">do scf calculation</h2>
<object data="/pdf/ucc.pdf" type="application/pdf" width="100%" height="600px">
  <p>the browser does not support PDFs. <a href="/pdf/ucc.pdf">Download the PDF</a>.</p>
</object>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Introduction]]></summary></entry><entry><title type="html">Pseudopotential Plane Wave</title><link href="http://localhost:4000/jekyll/update/2025/11/18/pwscf.html" rel="alternate" type="text/html" title="Pseudopotential Plane Wave" /><published>2025-11-18T11:41:29+08:00</published><updated>2025-11-18T11:41:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/11/18/pwscf</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/11/18/pwscf.html"><![CDATA[<h2 id="introduction">Introduction</h2>

<h2 id="do-scf-calculation">do scf calculation</h2>
<object data="/pdf/pwscf.pdf" type="application/pdf" width="100%" height="600px">
  <p>the browser does not support PDFs. <a href="/pdf/pwscf.pdf">Download the PDF</a>.</p>
</object>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Introduction]]></summary></entry><entry><title type="html">Gell-Mann Low Theorem</title><link href="http://localhost:4000/jekyll/update/2025/11/11/gellmann_low.html" rel="alternate" type="text/html" title="Gell-Mann Low Theorem" /><published>2025-11-11T20:41:29+08:00</published><updated>2025-11-11T20:41:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/11/11/gellmann_low</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/11/11/gellmann_low.html"><![CDATA[<h2 id="introduction">Introduction</h2>
<p>This is a  note of Gell-Mann Low Theorem based 
on book «Quantum Theory of Many-Particle Systems» Alexander L. Fetter and John Dirk Walecka</p>

<h2 id="notes">Notes</h2>

<object data="/pdf/green_function.pdf" type="application/pdf" width="100%" height="600px">
  <p>the browser does not support PDFs. <a href="/pdf/green_function.pdf">Download the PDF</a>.</p>
</object>

<p>why</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Introduction This is a note of Gell-Mann Low Theorem based on book «Quantum Theory of Many-Particle Systems» Alexander L. Fetter and John Dirk Walecka]]></summary></entry><entry><title type="html">Spectroscopic constant of diatomic molecule : HF as an example</title><link href="http://localhost:4000/jekyll/update/2025/10/28/hfbond.html" rel="alternate" type="text/html" title="Spectroscopic constant of diatomic molecule : HF as an example" /><published>2025-10-28T20:41:29+08:00</published><updated>2025-10-28T20:41:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/10/28/hfbond</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/10/28/hfbond.html"><![CDATA[<h2 id="background">Background</h2>
<p>HF is a diatomic molecule and  here we want to use it as an example to 
demostrate how to fitting spectroscopic constant.</p>

<h2 id="optimization-of-r_e">Optimization of \(R_e\)</h2>
<p>First of all ,we use molpro to optimize the equilibrum bond distance of HF molecule
using both caspt2 method and nevpt2 method</p>

<p>This is  an input which optimize HF using nevpt2/cc-pvqz</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">basis</span><span class="o">=</span><span class="n">cc</span><span class="o">-</span><span class="n">pvqz</span>
</span><span class="hll"><span class="n">angstrom</span>
</span><span class="n">geometry</span><span class="o">=</span><span class="p">{</span>
    <span class="n">angstrom</span><span class="p">;</span>
    <span class="no">H</span>  <span class="p">;</span>
    <span class="no">F</span> <span class="no">H</span> <span class="n">r</span> <span class="p">;</span>
<span class="p">}</span>
<span class="n">r</span><span class="o">=</span><span class="mf">0.9</span>
<span class="n">hf</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">hf</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span>    <span class="n">multi</span><span class="p">,</span>
<span class="n">occ</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,;</span>
<span class="n">closed</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span> <span class="p">;</span>
<span class="n">wf</span><span class="p">,</span><span class="n">elec</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">spin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">sym</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="n">put</span><span class="p">,</span><span class="n">molden</span><span class="p">,</span><span class="n">cas</span><span class="p">.</span><span class="nf">molden</span>
<span class="p">{</span>    <span class="n">nevpt2</span><span class="p">,</span>
    <span class="n">state</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">{</span><span class="n">optg</span><span class="p">,</span><span class="n">root</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">procedure</span><span class="o">=</span><span class="n">mycas</span><span class="p">}</span>
<span class="n">mycas</span><span class="o">=</span><span class="p">{</span><span class="n">hf</span><span class="p">;</span><span class="n">multi</span><span class="p">;</span><span class="n">nevpt2</span><span class="p">}</span></code></pre></figure>

<p>This is an optimization file for dsrg</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">import</span> <span class="n">forte</span>
</span><span class="hll">
</span><span class="n">molecule</span> <span class="p">{</span>
<span class="mi">0</span> <span class="mi">1</span>
<span class="no">H</span>
<span class="no">F</span> <span class="mi">1</span> <span class="mf">0.9</span>
<span class="p">}</span>

<span class="n">set</span> <span class="p">{</span>
  <span class="n">basis</span>                <span class="n">cc</span><span class="o">-</span><span class="n">pvqz</span>
  <span class="n">reference</span>            <span class="n">rhf</span>
  <span class="n">scf_type</span>             <span class="n">pk</span>
  <span class="n">e_convergence</span>        <span class="mi">10</span>
  <span class="n">d_convergence</span>        <span class="mi">10</span>
  <span class="n">restricted_docc</span>      <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">active</span>               <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">mcscf_type</span>           <span class="n">conv</span>
  <span class="n">mcscf_maxiter</span>        <span class="mi">100</span>
  <span class="n">mcscf_diis_start</span>     <span class="mi">20</span>
  <span class="n">mcscf_e_convergence</span>  <span class="mi">10</span>
  <span class="n">mcscf_r_convergence</span>  <span class="mi">8</span>
  <span class="n">g_convergence</span>        <span class="n">gau_verytight</span>
<span class="p">}</span>

<span class="n">set</span> <span class="n">forte</span> <span class="p">{</span>
  <span class="n">ref_type</span>             <span class="n">casscf</span>
  <span class="n">restricted_docc</span>      <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
  <span class="n">active</span>               <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">active_space_solver</span>  <span class="n">detci</span>
  <span class="n">correlation_solver</span>   <span class="n">dsrg</span><span class="o">-</span><span class="n">mrpt2</span>
  <span class="n">dsrg_s</span>               <span class="mf">0.5</span>
  <span class="n">force_diag_method</span>    <span class="kp">true</span>
<span class="p">}</span></code></pre></figure>

<table>
  <thead>
    <tr>
      <th>Basis Set</th>
      <th>CASPT2</th>
      <th>NEVPT2</th>
      <th>DSRG-PT2(s=0.5)</th>
      <th>DSRG-PT2(s=1.0)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>cc-pVDZ</td>
      <td>0.92033766</td>
      <td>0.92384987</td>
      <td>0.917399</td>
      <td>0.913450</td>
    </tr>
    <tr>
      <td>cc-pVTZ</td>
      <td>0.91719700</td>
      <td>0.92249350</td>
      <td>0.915964</td>
      <td>0.910931</td>
    </tr>
    <tr>
      <td>cc-pVQZ</td>
      <td>0.91579604</td>
      <td>0.92159519</td>
      <td>0.916780</td>
      <td>0.914105</td>
    </tr>
  </tbody>
</table>

<h2 id="calculation-of-spectroscopic-constant">Calculation of Spectroscopic Constant</h2>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"> <span class="o">&amp;</span><span class="no">VIBROT</span>
</span><span class="hll">  <span class="no">RoVibrational</span> <span class="n">spectrum</span>
</span>  <span class="no">Title</span> <span class="o">=</span> <span class="no">HF</span> <span class="p">(</span><span class="o">^</span><span class="mi">1</span> <span class="no">Pi_u</span><span class="p">)</span>
  <span class="no">Atoms</span> <span class="o">=</span> <span class="mi">0</span> <span class="no">H</span> <span class="mi">0</span> <span class="no">F</span>
  <span class="no">Potential</span>
<span class="mf">0.4000</span>	 <span class="o">-</span><span class="mf">98.39414876</span>
<span class="mf">0.4500</span>	 <span class="o">-</span><span class="mf">98.95737209</span>
<span class="mf">0.5000</span>	 <span class="o">-</span><span class="mf">99.33419285</span>
<span class="mf">0.5500</span>	 <span class="o">-</span><span class="mf">99.58745543</span>
<span class="mf">0.6000</span>	 <span class="o">-</span><span class="mf">99.75756806</span>
<span class="mf">0.6500</span>	 <span class="o">-</span><span class="mf">99.87102993</span>
<span class="mf">0.7000</span>	 <span class="o">-</span><span class="mf">99.94547732</span>
<span class="mf">0.7500</span>	 <span class="o">-</span><span class="mf">99.99282331</span>
<span class="mf">0.8000</span>	 <span class="o">-</span><span class="mf">100.02124762</span>
<span class="mf">0.8250</span>	 <span class="o">-</span><span class="mf">100.03021940</span>
<span class="mf">0.8500</span>	 <span class="o">-</span><span class="mf">100.03645446</span>
<span class="mf">0.8750</span>	 <span class="o">-</span><span class="mf">100.04040903</span>
<span class="mf">0.9000</span>	 <span class="o">-</span><span class="mf">100.04246762</span>
<span class="mf">0.9250</span>	 <span class="o">-</span><span class="mf">100.04295454</span>
<span class="mf">0.9500</span>	 <span class="o">-</span><span class="mf">100.04214339</span>
<span class="mf">0.9750</span>	 <span class="o">-</span><span class="mf">100.04026516</span>
<span class="mf">1.0000</span>	 <span class="o">-</span><span class="mf">100.03751494</span>
<span class="mf">1.0250</span>	 <span class="o">-</span><span class="mf">100.03405765</span>
<span class="mf">1.0500</span>	 <span class="o">-</span><span class="mf">100.03003295</span>
<span class="mf">1.0750</span>	 <span class="o">-</span><span class="mf">100.02555925</span>
<span class="mf">1.1000</span>	 <span class="o">-</span><span class="mf">100.02073718</span>
<span class="mf">1.1250</span>	 <span class="o">-</span><span class="mf">100.01565243</span>
<span class="mf">1.1500</span>	 <span class="o">-</span><span class="mf">100.01037810</span>
<span class="mf">1.2000</span>	 <span class="o">-</span><span class="mf">99.99950138</span>
<span class="mf">1.2500</span>	 <span class="o">-</span><span class="mf">99.98850518</span>
<span class="mf">1.3000</span>	 <span class="o">-</span><span class="mf">99.97767860</span>
<span class="mf">1.3500</span>	 <span class="o">-</span><span class="mf">99.96722798</span>
<span class="mf">1.4000</span>	 <span class="o">-</span><span class="mf">99.95729554</span>
<span class="mf">1.4500</span>	 <span class="o">-</span><span class="mf">99.94797370</span>
<span class="mf">1.5000</span>	 <span class="o">-</span><span class="mf">99.93931638</span>
<span class="mf">1.5500</span>	 <span class="o">-</span><span class="mf">99.93134832</span>
<span class="mf">1.6000</span>	 <span class="o">-</span><span class="mf">99.92407265</span>
<span class="mf">1.6500</span>	 <span class="o">-</span><span class="mf">99.91747685</span>
<span class="mf">1.7000</span>	 <span class="o">-</span><span class="mf">99.91153737</span>
<span class="mf">1.7500</span>	 <span class="o">-</span><span class="mf">99.90622293</span>
<span class="mf">1.8000</span>	 <span class="o">-</span><span class="mf">99.90149693</span>
<span class="mf">1.8500</span>	 <span class="o">-</span><span class="mf">99.89731924</span>
<span class="mf">1.9000</span>	 <span class="o">-</span><span class="mf">99.89364747</span>
<span class="mf">1.9500</span>	 <span class="o">-</span><span class="mf">99.89043804</span>
<span class="mf">2.0000</span>	 <span class="o">-</span><span class="mf">99.88764711</span>
<span class="mf">2.0500</span>	 <span class="o">-</span><span class="mf">99.88523151</span>
<span class="mf">2.1000</span>	 <span class="o">-</span><span class="mf">99.88314945</span>
<span class="mf">2.1500</span>	 <span class="o">-</span><span class="mf">99.88136132</span>
<span class="mf">2.2000</span>	 <span class="o">-</span><span class="mf">99.87983017</span>
<span class="mf">2.3000</span>	 <span class="o">-</span><span class="mf">99.87740696</span>
<span class="mf">2.4000</span>	 <span class="o">-</span><span class="mf">99.87564961</span>
<span class="mf">2.5000</span>	 <span class="o">-</span><span class="mf">99.87438007</span>
<span class="mf">2.6000</span>	 <span class="o">-</span><span class="mf">99.87346539</span>
<span class="mf">2.7000</span>	 <span class="o">-</span><span class="mf">99.87280811</span>
<span class="mf">2.8000</span>	 <span class="o">-</span><span class="mf">99.87233707</span>
<span class="mf">2.9000</span>	 <span class="o">-</span><span class="mf">99.87200028</span>
<span class="mf">3.0000</span>	 <span class="o">-</span><span class="mf">99.87175975</span>
<span class="mf">4.0000</span>	 <span class="o">-</span><span class="mf">99.87116318</span>
<span class="mf">5.0000</span>	 <span class="o">-</span><span class="mf">99.87114070</span>
 <span class="no">DistUnit</span> <span class="o">=</span> <span class="n">angstrom</span>
  <span class="no">EnerUnit</span> <span class="o">=</span> <span class="n">hartree</span> 
  <span class="no">Grid</span> <span class="o">=</span> <span class="mi">450</span>
  <span class="no">Range</span> <span class="o">=</span> <span class="mf">0.85</span> <span class="mf">9.4</span>
  <span class="no">Vibrations</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">scale</span></code></pre></figure>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background HF is a diatomic molecule and here we want to use it as an example to demostrate how to fitting spectroscopic constant.]]></summary></entry><entry><title type="html">Generate auxiliary basis set using autoaux</title><link href="http://localhost:4000/jekyll/update/2025/10/28/autoaux.html" rel="alternate" type="text/html" title="Generate auxiliary basis set using autoaux" /><published>2025-10-28T20:41:29+08:00</published><updated>2025-10-28T20:41:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/10/28/autoaux</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/10/28/autoaux.html"><![CDATA[<h2 id="background">Background</h2>
<p>Density Fitting is a common technique to accelerate 
calculation in quantum chemistry. And we need auxiliary 
basis set.For some basis set there are pre-optimized auxiliary basisset 
for other we need to use autoaux to generate.
The reference is</p>

<p>doi: 10.1021/acs.jctc.6b01041</p>

<h2 id="basis-set-exchange">Basis Set Exchange</h2>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">from</span> <span class="n">basis_set_exchange</span><span class="p">.</span><span class="nf">api</span> <span class="n">import</span> <span class="n">get_basis</span>
</span><span class="hll"><span class="n">bs</span><span class="o">=</span><span class="n">get_basis</span><span class="p">(</span><span class="s2">"cc-pv5z"</span><span class="p">,</span><span class="n">elements</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span><span class="n">fmt</span><span class="o">=</span><span class="s2">"psi4"</span><span class="p">,</span>
</span>             <span class="n">get_aux</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">fhand</span><span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">"cc-pv5z-autoaux"</span><span class="p">,</span><span class="s2">"w"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bs</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">fhand</span><span class="p">)</span>
<span class="n">fhand</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span></code></pre></figure>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background Density Fitting is a common technique to accelerate calculation in quantum chemistry. And we need auxiliary basis set.For some basis set there are pre-optimized auxiliary basisset for other we need to use autoaux to generate. The reference is]]></summary></entry><entry><title type="html">Visulize orbital in psi4 using cube</title><link href="http://localhost:4000/jekyll/update/2025/10/28/psi4cube.html" rel="alternate" type="text/html" title="Visulize orbital in psi4 using cube" /><published>2025-10-28T20:41:29+08:00</published><updated>2025-10-28T20:41:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/10/28/psi4cube</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/10/28/psi4cube.html"><![CDATA[<h2 id="background">Background</h2>

<h2 id="generate-cube-file-in-psi4">Generate cube file in psi4</h2>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">e_hf</span><span class="p">,</span><span class="n">hf_wfn</span><span class="o">=</span><span class="n">psi4</span><span class="p">.</span><span class="nf">energy</span><span class="p">(</span><span class="s2">"scf"</span><span class="p">,</span><span class="n">return_wfn</span><span class="o">=</span><span class="no">True</span><span class="p">)</span>
</span><span class="hll"><span class="n">cp</span><span class="o">=</span><span class="n">psi4</span><span class="p">.</span><span class="nf">core</span><span class="o">.</span><span class="no">CubeProperties</span><span class="p">(</span><span class="n">hf_wfn</span><span class="p">)</span>
</span><span class="n">orb_index</span><span class="o">=</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">]</span> <span class="c1"># start with zero !!</span>
<span class="n">orb_label</span><span class="o">=</span><span class="p">[</span><span class="s2">"homo"</span><span class="p">,</span><span class="s2">"lumo"</span><span class="p">]</span>
<span class="n">cp</span><span class="p">.</span><span class="nf">compute_orbitals</span><span class="p">(</span><span class="n">hf_wfn</span><span class="o">.</span><span class="no">Ca</span><span class="p">(),</span><span class="n">indices</span><span class="o">=</span><span class="n">orb_index</span><span class="p">,</span><span class="n">labels</span><span class="o">=</span><span class="n">orb_label</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="s2">"planar"</span><span class="p">)</span></code></pre></figure>

<p>This will generate cubes files</p>
<h2 id="visualize-file-in-vmdcube">Visualize file in vmdcube</h2>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">from</span> <span class="n">vmdcube</span> <span class="n">import</span> <span class="no">VMDCube</span>
</span><span class="hll"><span class="n">vmd</span> <span class="o">=</span> <span class="no">VMDCube</span><span class="p">()</span>
</span><span class="n">vmd</span><span class="p">.</span><span class="nf">cubedir</span> <span class="o">=</span> <span class="s2">"cubes"</span> <span class="c1"># Directory containing the cube files</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">positive_color</span> <span class="o">=</span> <span class="s2">"#C1844E"</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">negative_color</span> <span class="o">=</span> <span class="s2">"#8BC14E"</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">isovalues</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="o">-</span><span class="mf">0.05</span><span class="p">]</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">ambient</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="c1"># default is 0.6</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">diffuse</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="c1"># default is 0.5</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">mirror</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># default is 0.0</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">opacity</span> <span class="o">=</span> <span class="mf">0.55</span> <span class="c1"># default is 1.0</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">specular</span> <span class="o">=</span> <span class="mf">0.96</span> <span class="c1"># default is 0.96</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">shininess</span> <span class="o">=</span> <span class="mf">0.75</span> <span class="c1"># default is 0.75</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">outline</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="c1"># default is 0.0</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">outlinewidth</span> <span class="o">=</span> <span class="mf">0.6</span> <span class="c1"># default is 0.0</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">scale</span> <span class="o">=</span> <span class="mf">0.7</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">height</span> <span class="o">=</span> <span class="mi">800</span> <span class="c1"># Height of the output image</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">width</span> <span class="o">=</span> <span class="mi">800</span> <span class="c1"># Width of the output image</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">run</span><span class="p">()</span>
<span class="n">vmd</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span></code></pre></figure>

<p>command to open .tga image files</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">eog</span> <span class="n">image</span><span class="p">.</span><span class="nf">tga</span>
</span></code></pre></figure>

<p>Some expamles  are homo and lumo of ethylene 
<img src="/image/cubes/FabConvert.com_planar_8_orb7.png" alt="AltText" />
<img src="/image/cubes/FabConvert.com_planar_12_orb11.png" alt="AltText" /></p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background]]></summary></entry><entry><title type="html">Simplified Tamm-Dancoff approximation to TD-DFT</title><link href="http://localhost:4000/jekyll/update/2025/08/08/stda.html" rel="alternate" type="text/html" title="Simplified Tamm-Dancoff approximation to TD-DFT" /><published>2025-08-08T20:41:29+08:00</published><updated>2025-08-08T20:41:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/08/08/stda</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/08/08/stda.html"><![CDATA[<h2 id="background">Background</h2>
<p>reference</p>

<p>The time-dependent density functional theory (TD-DFT) responce 
problem can be expressed as the following non-Hermitian eigenvalue problem</p>

<p>\(\begin{pmatrix}
 A &amp; B \\
 B^{*}&amp; A^{*} 
\end{pmatrix}
\begin{pmatrix}
X \\
Y
\end{pmatrix}
= 
\begin{pmatrix}
\omega &amp; 0\\
0&amp; \omega 
\end{pmatrix}
\begin{pmatrix}
X \\
Y
\end{pmatrix}\)
In the Tamm-Dancoff approximation (TDA), the matrix B is neglected which leads to</p>

<p>\(AX=\omega X\)
Three simplifications then yield the simplified Tamm-Dancoff approach (sTDA)</p>
<ol>
  <li>Neglect the responce of exchange-correlation functional</li>
  <li>Evaluate the two-electron integrals as damped Coulomb interactions between transition/charge density monopoles</li>
  <li>Restrict the configuration sapce to a user-specified energy range of excitations</li>
</ol>

<p>The elements of the simplified matrix are then given as</p>

<p>\(A^\prime_{ia,jb}=\delta_{ij}\delta_{ab}(\epsilon_a-\epsilon_b)+\sum_{A,B}^{N_{atoms}}
(s_k q_{ia}^{A}\gamma_{AB}^{K}q_{jb}^B-q_{ia}^{A}\gamma_{AB}^{J}q_{jb}^B)\)
\(q_{ia}^{A}\) are the transition/charge density monopoles located on atom A .
These are obtained from Lowdin population analysis.
\(\epsilon_p\) is the Kon-Sham orbital energy of orbital p.
In the spin-restricted case,\(s_k=2\) for singlet-singlet transition ,\(s_k=0\) for singlet-triplet exictaions.
\(\gamma_{AB}^K\) and \(\gamma_{AB}^J\) are the Mataga-Nishimoto-Ohno-Klopman damped Coulomb operators for exchange-type 
and Coulom-type integrals ,respectively.
\(\gamma_{AB}^{J}=(\frac{1}{R_{AB}^\beta+(a_x\eta)^{-\beta}})^{1/\beta}\)</p>

<h2 id="tddft">TDDFT</h2>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background reference]]></summary></entry><entry><title type="html">QUESTDB and excited state quantum chemistry method</title><link href="http://localhost:4000/jekyll/update/2025/07/03/questdb.html" rel="alternate" type="text/html" title="QUESTDB and excited state quantum chemistry method" /><published>2025-07-03T21:28:29+08:00</published><updated>2025-07-03T21:28:29+08:00</updated><id>http://localhost:4000/jekyll/update/2025/07/03/questdb</id><content type="html" xml:base="http://localhost:4000/jekyll/update/2025/07/03/questdb.html"><![CDATA[<h2 id="background">Background</h2>
<p>QUESTDB( https://lcpq.github.io/QUESTDB_website/ )
is quantum excited state database which benchmark quantum chemistry method for excited state.
The Journal of Physical Chemistry Letters 2020 116, 2374-2383
DOI: 10.1021/acs.jpclett.0c00014</p>
<h2 id="develop-theories-for-excited-is-more-complex">Develop theories for excited is more complex</h2>
<ol>
  <li>excited state lack a proper vairational principle</li>
  <li>excited state have very difference natures ( \(\pi-&gt;\pi*\),\(n-&gt;\pi*\) charge transfer ,double excitateion ,valence ,Rydberg ,singlet ,triplet )</li>
</ol>

<h2 id="method">Method</h2>
<ol>
  <li>first ab initial method for excited was CIS in 1970 , error ~1 eV, CIS(D) has error 0.2-0.3 eV</li>
  <li>CASSCF and CASPT2,NEVPT2 is more reliable and has error 0.1-0.2</li>
  <li>TD-DFT 0.2-0.4 ev for low lying valence excited state, but not goot for charge-transfer , Rydberg state and double excitation.</li>
  <li>EOM-CCSD 0.1 eV</li>
  <li>ADC (2) 0.1-0.2 ev  ADC(3)</li>
  <li>BSE GW  0.1-0.3 EV</li>
  <li>selected CI (SCI)
    <h2 id="usage">Usage</h2>
    <p>You can download the geometry and reference energy from QUESTDB here is an example
I calculate EOM-CCSD of acetaldehyde using molpro</p>
    <h3 id="input">input</h3>
    <p>geometry download from questdb</p>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="mi">7</span>
</span><span class="hll">
</span><span class="no">C</span>   <span class="o">-</span><span class="mf">0.00124094</span>            <span class="mf">0.00000000</span>            <span class="mf">0.46104598</span>
<span class="no">C</span>   <span class="o">-</span><span class="mf">0.93054640</span>            <span class="mf">0.00000000</span>           <span class="o">-</span><span class="mf">0.71424991</span>
<span class="no">O</span>    <span class="mf">1.20624568</span>            <span class="mf">0.00000000</span>            <span class="mf">0.38083840</span>
<span class="no">H</span>   <span class="o">-</span><span class="mf">0.49162964</span>            <span class="mf">0.00000000</span>            <span class="mf">1.44957198</span>
<span class="no">H</span>   <span class="o">-</span><span class="mf">1.57671241</span>            <span class="mf">0.87868017</span>           <span class="o">-</span><span class="mf">0.66257994</span>
<span class="no">H</span>   <span class="o">-</span><span class="mf">1.57671241</span>           <span class="o">-</span><span class="mf">0.87868017</span>           <span class="o">-</span><span class="mf">0.66257994</span>
<span class="no">H</span>   <span class="o">-</span><span class="mf">0.37065389</span>            <span class="mf">0.00000000</span>           <span class="o">-</span><span class="mf">1.64609256</span></code></pre></figure>

<p>molpro input</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll"><span class="n">basis</span><span class="o">=</span><span class="n">aug</span><span class="o">-</span><span class="n">cc</span><span class="o">-</span><span class="n">pvtz</span>    <span class="o">!</span> <span class="n">define</span> <span class="n">basis</span> <span class="n">set</span>
</span><span class="hll"><span class="n">geometry</span><span class="o">=</span><span class="n">acetaldehyde</span><span class="p">.</span><span class="nf">xyz</span>  <span class="o">!</span> <span class="n">read</span> <span class="n">geometry</span>
</span><span class="n">hf</span>                         <span class="o">!</span> <span class="k">do</span> <span class="n">scf</span> <span class="n">calculation</span>
<span class="n">ccsd</span>                       <span class="o">!</span> <span class="k">do</span> <span class="n">ccsd</span> <span class="n">calculation</span>
<span class="n">start</span> <span class="p">,</span><span class="mf">4000.2</span> <span class="n">save</span> <span class="mf">4000.2</span> <span class="o">!</span> <span class="n">save</span> <span class="n">final</span> <span class="no">T</span> <span class="n">amplitudes</span>
<span class="n">eom</span> <span class="mf">2.1</span> <span class="mf">1.1</span>  <span class="mf">1.2</span>  <span class="mf">2.2</span>     <span class="o">!</span> <span class="n">ground</span> <span class="n">state</span> <span class="n">is</span> <span class="mf">1.1</span> <span class="n">first</span> <span class="n">exited</span> <span class="n">state</span> <span class="n">is</span> <span class="mf">1.2</span></code></pre></figure>

<p>output</p>

<figure class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="hll">   <span class="no">Final</span> <span class="no">Results</span><span class="p">:</span>
</span><span class="hll">   <span class="o">==============</span>
</span> 
   <span class="no">State</span>    <span class="no">Exc</span><span class="o">.</span> <span class="no">Energy</span>    <span class="no">Total</span> <span class="no">Energy</span>     <span class="no">Weight</span><span class="p">(</span><span class="no">S</span><span class="p">)</span>     <span class="no">Weight</span><span class="p">(</span><span class="no">D</span><span class="p">)</span>      <span class="no">Delta</span> <span class="no">E</span>    <span class="no">Conv</span>   <span class="no">Max</span><span class="o">.</span> <span class="no">Coef</span><span class="o">.</span>     <span class="no">Excitation</span>
    <span class="mf">1.1</span>     <span class="mf">0.00000000</span>    <span class="o">-</span><span class="mf">153.57317406</span>     <span class="mf">0.635E-02</span>     <span class="mf">0.156E+00</span>    <span class="o">-</span><span class="mf">0.124E-06</span>     <span class="no">Y</span>
    <span class="mf">1.2</span>     <span class="mf">0.16029771</span>    <span class="o">-</span><span class="mf">153.41287635</span>     <span class="mf">0.928E+00</span>     <span class="mf">0.724E-01</span>     <span class="mf">0.122E-06</span>     <span class="no">Y</span>    <span class="o">-</span><span class="mf">0.76471</span>     <span class="mf">10.1</span> <span class="o">-&gt;</span>  <span class="mf">6.2</span>
    <span class="mf">2.1</span>     <span class="mf">0.25671913</span>    <span class="o">-</span><span class="mf">153.31645494</span>     <span class="mf">0.924E+00</span>     <span class="mf">0.757E-01</span>     <span class="mf">0.837E-06</span>     <span class="no">Y</span>    <span class="o">-</span><span class="mf">0.75379</span>     <span class="mf">10.1</span> <span class="o">-&gt;</span> <span class="mf">11.1</span>
    <span class="mf">2.2</span>     <span class="mf">0.29101596</span>    <span class="o">-</span><span class="mf">153.28215811</span>     <span class="mf">0.924E+00</span>     <span class="mf">0.759E-01</span>    <span class="o">-</span><span class="mf">0.351E-06</span>     <span class="no">Y</span>    <span class="o">-</span><span class="mf">0.81336</span>     <span class="mf">10.1</span> <span class="o">-&gt;</span>  <span class="mf">3.2</span></code></pre></figure>

<h3 id="conclusion">Conclusion</h3>
<p>you can search</p>]]></content><author><name></name></author><category term="jekyll" /><category term="update" /><summary type="html"><![CDATA[Background QUESTDB( https://lcpq.github.io/QUESTDB_website/ ) is quantum excited state database which benchmark quantum chemistry method for excited state. The Journal of Physical Chemistry Letters 2020 116, 2374-2383 DOI: 10.1021/acs.jpclett.0c00014 Develop theories for excited is more complex excited state lack a proper vairational principle excited state have very difference natures ( \(\pi-&gt;\pi*\),\(n-&gt;\pi*\) charge transfer ,double excitateion ,valence ,Rydberg ,singlet ,triplet )]]></summary></entry></feed>